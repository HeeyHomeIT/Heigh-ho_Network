/*! Pc.Heigh-ho.Renovation-1.0.0.js 2017-03-23 */
!function(){var a,b,c=angular.module("heeyhomeApp"),d="/api/public/shoplist/gettags",e="/api/public/shoplist",f=$.cookie("userId"),g=$.cookie("userType");f=null!=f&&""!=f&&void 0!=f?$.base64.decode($.cookie("userId")):"";var h={userid:f,servicearea:1,workernum:1,servicetag:1,shopage:1,orderKey:0,pageVal:1,limitVal:4},i={1:"平台实名认证",2:"保证金",3:"团队保险",4:"两年质保维修"},j={init:function(){j.initEvent()},initEvent:function(){var a=this;a.initShopListGetTagsEvent(),h={userid:f,servicearea:1,workernum:1,servicetag:1,shopage:1,orderKey:0,pageVal:1,limitVal:4},shopListContHandler.listContentEvent(h)},initShopListGetTagsEvent:function(){$.ajax({url:d,type:"GET",async:!0,dataType:"jsonp",complete:function(){$(".fliter").removeClass("loagbg")}}).done(function(a){if(null!=a&&"000"==a.code){var b="";$.each(a.data,function(a,c){b+='<div class="fliter_'+a+'"  data-name='+a+"  >",$.each(c,function(a,c){switch(a){case 0:b+='<span class="fliter_name">'+c+'</span><ul class="fliter_tab" >';break;case 1:b+='<li class="active" data-label="'+a+'" >',b+="<a>"+c+"</a></li>";break;default:b+='<li class="" data-label="'+a+'" >',b+="<a>"+c+"</a></li>"}}),b+="</ul></div>"}),$(".fliter").html(b),shopListTabSelectHandler.tabSelectEvent()}})}};shopListTabSelectHandler={tabSelectEvent:function(){var a=$(".fliter div li");a.off().on("click",function(){$(this).addClass("active").siblings().removeClass("active");var a=$(this).closest("div"),b=a.siblings();h[a.data("name")]=$(this).data("label"),$.each(b,function(a){h[b.eq(a).data("name")]=b.eq(a).find("li.active").data("label")}),shopListContHandler.listContentEvent(h)})}},shopListContHandler={listContentEvent:function(b){$.ajax({url:e,type:"GET",async:!0,dataType:"jsonp",data:{user_id:b.userid,servicearea:b.servicearea,workernum:b.workernum,servicetag:b.servicetag,shopage:b.shopage,order:b.orderKey,page:b.pageVal,limit:b.limitVal},complete:function(){$(".shop_summary").removeClass("slloagbg")}}).done(function(b){b&&"000"==b.code?(a=b.data[0].total,$(".number").text(a),$(".shop_summary").html(spliceShopListContHandler.spliceStrEvent(b.data)),shopListPageHandler.pageContentEvent(),orderModuleHandler.orderClickEvent()):($(".number").text(0),$(".shop_summary").html('<div class="nullpage"><i>&nbsp;</i><span>店铺消失了,看看其他的店铺...</span></div>'),$(".page_div3").empty())}),$(document).on("click",".enter_shop,.Jshop",function(){sessionStorage.setItem("iscollected",$(this).attr("iscollected")),sessionStorage.setItem("wObj","{}");var a=$(this).parents(".shop_box").attr("data-shopid");$.cookie("shopid",$.base64.encode(a))})}},orderModuleHandler={orderClickEvent:function(){var a=$(".content_title .sort"),b=a.parent().data("name");a.off("click").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),h[b]=$(this).data("label"),shopListContHandler.listContentEvent(h)})}},spliceShopListContHandler={spliceStrEvent:function(a){var b="";return $.each(a,function(a,c){b+='<div class="shop_box" data-shopid="'+c.shop_id+'" data-shopperid="'+c.shopper_id+'">',b+='\t<div class="left_image">',null!=c.shop_img&&""!=c.shop_img&&(b+='\t\t<a class="Jshop" rel="nofollow" href="view_shop.html#/shopdetails?pos='+c.shop_id+'" iscollected="'+c.iscollected+'" target="_blank" ><img src="'+c.shop_img+'"></a>'),b+='\t\t<div class="image-background_1"></div>',b+='\t\t<div class="image-background_2"></div>',b+="\t</div>",b+='\t<div class="right_summary">',b+='\t\t<div class="shop_name">',b+="\t\t\t<h2>"+(null!=c.shop_name&&""!=c.shop_name?c.shop_name:"无")+"</h2>",$.each(c.authentication,function(a,c){""!=c&&null!=c&&(b+='\t\t<span style="background-position:'+-20*(c-1)+'px 0" title='+i[c]+"></span>")}),b+="\t\t</div>",b+='\t\t<div class="shop_introduce">',b+="\t\t\t<p>常住地址: <span>"+(null!=c.shop_address&&""!=c.shop_address?c.shop_address:"无")+"</span></p>",b+="\t\t\t<p>服务范围: ",$.each(c.servicearea,function(a,c){b+=""!=c&&null!=c?"\t\t<span>"+c+"</span>":"\t\t<span>无</span>"}),b+="\t\t\t</p>",b+="\t\t\t<p>擅长风格: ",$.each(c.servicetag,function(a,c){b+=""!=c&&null!=c?"\t\t<span>"+c+"</span>":"无"}),b+="\t\t\t</p>";var d=c.opentime;d=d.substring(0,10),b+="\t\t\t<p>开店时间：<span>"+d+"</span></p>",b+="\t\t</div>",b+='\t\t<div class="shop_icon clearfix">',b+='\t\t\t<div title ="浏览数">',b+='\t\t\t\t<em class="sprite icon_pnumber" ></em>',b+="\t\t\t\t<span>"+c.shop_scan+"</span>",b+="\t\t\t</div>",b+='\t\t\t<div title ="成交量">',b+='\t\t\t\t<em class="sprite icon_turnover" ></em>',b+="\t\t\t\t<span>"+c.shop_volume+"</span>",b+="\t\t\t</div>",b+="\t\t</div>",b+='\t\t<div class="shop_assess">',b+="\t\t\t<p>工程质量<span>"+c.shop_score.projectquality+"</span>分</p>",b+="\t\t\t<p>服务态度<span>"+c.shop_score.serviceattitude+"</span>分</p>",b+="\t\t\t<p>综合评价<span>"+c.shop_score.overallmerit+"</span>分</p>",b+="\t\t</div>",b+='\t\t<div class="shop_button">',b+=' <span class="collect_shop">'+("1"==c.iscollected&&1==$.base64.decode(g)?"已收藏":"未收藏")+"</span>",b+='\t\t\t<a class="enter_shop" rel="nofollow" href="view_shop.html#/shopdetails?pos='+c.shop_id+'" iscollected="'+c.iscollected+'" target="_blank" >进入店铺</a>',b+="\t\t</div>",b+="\t</div>",b+="</div>"}),b}},shopListPageHandler={pageContentEvent:function(){b=Math.ceil(a/4),$(".page_number>div").append($(".page_div3").empty().paging({total:b,animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:e,ajaxData:{user_id:h.userid,servicearea:h.servicearea,workernum:h.workernum,servicetag:h.servicetag,shopage:h.shopage,order:h.orderKey,page:h.pageVal,limit:h.limitVal},dataOperate:function(a){$.cookie("userType"),$(".shop_summary").html(spliceShopListContHandler.spliceStrEvent(a.data))}}))}},c.controller("myShoplist",["$scope","$http",function(){j.init()}])}();