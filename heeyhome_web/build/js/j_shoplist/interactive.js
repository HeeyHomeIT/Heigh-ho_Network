/*! Pc.Heigh-ho.Renovation-1.0.0.js 2017-01-22 */
!function(){var a,b,c=angular.module("heeyhomeApp"),d="http://www.heeyhome.com/api/public/shoplist/gettags",e="http://www.heeyhome.com/api/public/shoplist",f=$.cookie("userId"),g=$.cookie("userType");f=null!=f&&""!=f&&void 0!=f?$.base64.decode($.cookie("userId")):"";var h={userid:f,servicearea:1,workernum:1,servicetag:1,shopage:1,orderKey:0,pageVal:1,limitVal:4},i={init:function(){i.initEvent()},initEvent:function(){var a=this;a.initShopListGetTagsEvent(),h={userid:f,servicearea:1,workernum:1,servicetag:1,shopage:1,orderKey:0,pageVal:1,limitVal:4},shopListContHandler.listContentEvent(h)},initShopListGetTagsEvent:function(){$.ajax({url:d,type:"GET",async:!0,dataType:"jsonp",complete:function(){$(".fliter").removeClass("loagbg")}}).done(function(a){if(null!=a&&"000"==a.code){var b="";$.each(a.data,function(a,c){b+='<div class="fliter_'+a+'"  data-name='+a+"  >",$.each(c,function(a,c){switch(a){case 0:b+='<span class="fliter_name">'+c+'</span><ul class="fliter_tab" >';break;case 1:b+='<li class="active" data-label="'+a+'" >',b+="<a>"+c+"</a></li>";break;default:b+='<li class="" data-label="'+a+'" >',b+="<a>"+c+"</a></li>"}}),b+="</ul></div>"}),$(".fliter").html(b),shopListTabSelectHandler.tabSelectEvent()}})}};shopListTabSelectHandler={tabSelectEvent:function(){var a=$(".fliter div li");a.off().on("click",function(){$(this).addClass("active").siblings().removeClass("active");var a=$(this).closest("div"),b=a.siblings();h[a.data("name")]=$(this).data("label"),$.each(b,function(a){h[b.eq(a).data("name")]=b.eq(a).find("li.active").data("label")}),shopListContHandler.listContentEvent(h)})}},shopListContHandler={listContentEvent:function(b){console.log(b),$.ajax({url:e,type:"GET",async:!0,dataType:"jsonp",data:{user_id:b.userid,servicearea:b.servicearea,workernum:b.workernum,servicetag:b.servicetag,shopage:b.shopage,order:b.orderKey,page:b.pageVal,limit:b.limitVal},complete:function(){$(".shop_summary").removeClass("vrloagbg")}}).done(function(b){b&&"000"==b.code?(a=b.data[0].total,$(".number").text(a),$(".shop_summary").html(spliceShopListContHandler.spliceStrEvent(b.data)),shopListPageHandler.pageContentEvent(),orderModuleHandler.orderClickEvent()):($(".number").text(0),$(".shop_summary").html('<div class="nullpage"><i>&nbsp;</i><span>店铺消失了,看看其他的店铺...</span></div>'),$(".page_div3").empty())}),$(document).on("click",".collect_shop",function(){1==$.base64.decode(g)?"已收藏"==$(this).val()?layer.msg("已收藏过~~"):layer.alert("您需要进入店铺后才能收藏哦~~"):2==$.base64.decode(g)&&layer.alert("工长暂时还不能收藏店铺哦~~")}),$(document).on("click",".enter_shop",function(){sessionStorage.setItem("iscollected",$(this).attr("iscollected"))})}},orderModuleHandler={orderClickEvent:function(){var a=$(".content_title .sort"),b=a.parent().data("name");a.off("click").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),h[b]=$(this).data("label"),shopListContHandler.listContentEvent(h)})}},spliceShopListContHandler={spliceStrEvent:function(a){var b="";return $.each(a,function(a,c){b+='<div class="shop_box" data-shopid="'+c.shop_id+'" data-shopperid="'+c.shopper_id+'">',b+='\t<div class="left_image">',b+='\t\t<a href="#nogo"><img src="http://www.heeyhome.com/'+c.shop_img+'"></a>',b+='\t\t<div class="image-background_1"></div>',b+='\t\t<div class="image-background_2"></div>',b+="\t</div>",b+='\t<div class="right_summary">',b+='\t\t<div class="shop_name">',b+="\t\t\t<h2>"+c.shop_name+"</h2>",$.each(c.authentication,function(a,c){b+='\t\t<img src="http://www.heeyhome.com/'+c+'">'}),b+="\t\t</div>",b+='\t\t<div class="shop_introduce">',b+="\t\t\t<p>常住地址: <span>"+c.shop_address+"</span></p>",b+="\t\t\t<p>服务范围: ",$.each(c.servicearea,function(a,c){b+="\t\t<span>"+c+"</span>"}),b+="\t\t\t</p>",b+="\t\t\t<p>擅长风格: ",$.each(c.servicetag,function(a,c){b+="\t\t<span>"+c+"</span>"}),b+="\t\t\t</p>",b+="\t\t\t<p>店铺年限：<span>"+c.opentime+"</span>年</p>",b+="\t\t</div>",b+='\t\t<div class="shop_icon clearfix">',b+="\t\t\t<div>",b+='\t\t\t\t<em class="sprite icon_pnumber"></em>',b+="\t\t\t\t<span>"+c.shop_scan+"</span>",b+="\t\t\t</div>",b+="\t\t\t<div>",b+='\t\t\t\t<em class="sprite icon_turnover"></em>',b+="\t\t\t\t<span>"+c.shop_volume+"</span>",b+="\t\t\t</div>",b+="\t\t</div>",b+='\t\t<div class="shop_assess">',b+="\t\t\t<p>工程质量<span>"+c.shop_score.projectquality+"</span>分</p>",b+="\t\t\t<p>服务态度<span>"+c.shop_score.serviceattitude+"</span>分</p>",b+="\t\t\t<p>综合评价<span>"+c.shop_score.overallmerit+"</span>分</p>",b+="\t\t</div>",b+='\t\t<div class="shop_button">',b+='\t\t\t<input type="button" class="collect_shop" value="'+("1"==c.iscollected&&1==$.base64.decode(g)?"已收藏":"收藏")+'">',b+='\t\t\t<a class="enter_shop" rel="nofollow" href="view_shop.html#/shopdetails?pos='+c.shop_id+'" iscollected="'+c.iscollected+'">进入店铺</a>',b+="\t\t</div>",b+="\t</div>",b+="</div>"}),b}},shopListPageHandler={pageContentEvent:function(){b=Math.ceil(a/4),$(".page_number>div").append($(".page_div3").empty().paging({total:b,animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:e,ajaxData:{user_id:h.userid,servicearea:h.servicearea,workernum:h.workernum,servicetag:h.servicetag,shopage:h.shopage,order:h.orderKey,page:h.pageVal,limit:h.limitVal},dataOperate:function(a){$.cookie("userType"),$(".shop_summary").html(spliceShopListContHandler.spliceStrEvent(a.data))}}))}},c.controller("myShoplist",["$scope","$http",function(){i.init()}])}();