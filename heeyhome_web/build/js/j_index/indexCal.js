/*! Pc.Heigh-ho.Renovation-1.0.0.js 2017-03-23 */
define(["app"],function(a){!function(){var b={},c="未保存工艺",d="已保存工艺",e="/api/public/costcalculator/count",f={init:function(){var a=this;a.houseSelectEvent(),a.selectRoomTechnologyEvent(),a.roomConfigureSelectEvent(),a.lastdivClickEvent(),a.sumbitCalEvent()},houseSelectEvent:function(){var a,b,c,d,e,f,g=this;$(".housediv div").on("click",function(a){if(a.stopPropagation(),c=$("#c_area").val(),null==c||void 0==c||""==$.trim(c))return void layer.msg("请先输入建筑面积");if(c>=70&&80>c)d="<li>1</li><li>2</li>",e="<li>1</li>",f="<li>1</li><li>2</li>";else if(c>=80&&90>c)d="<li>1</li><li>2</li><li>3</li>",e="<li>1</li>",f="<li>1</li><li>2</li>";else if(c>=90&&120>c)d="<li>1</li><li>2</li><li>3</li>",e="<li>1</li><li>2</li>",f="<li>1</li><li>2</li><li>3</li>";else if(c>=120&&140>c)d="<li>1</li><li>2</li><li>3</li><li>4</li>",e="<li>1</li><li>2</li>",f="<li>1</li><li>2</li><li>3</li>";else{if(!(c>=140&&160>=c))return void layer.msg("暂支持70m²~160m²户型，其他户型请咨询客服");d="<li>1</li><li>2</li><li>3</li><li>4</li>",e="<li>1</li><li>2</li><li>3</li>",f="<li>1</li><li>2</li><li>3</li>"}$(".room ul").html(d),$(".bathroom ul").html(e),$(".balcony ul").html(f),$(this).hasClass("item_hover_180")?$(this).removeClass("item_hover_180"):$(this).addClass("item_hover_180"),$(this).find("ul").slideToggle(),$(this).siblings().removeClass("item_hover_180").find("ul").slideUp()}),$(".housediv ul").delegate("li","click",function(){b=$(this).text(),$(this).parent().prev().text(b),$(this).parent().parent().hasClass("room")&&(a=g.changeTitleEvent(parseInt(b)),$(".Jtitle").html(a),1!=parseInt(b)?($(".roomsdiv a.add-btn").removeClass("off").addClass("Jcursor"),g.comboboxInitEvent(),g.roomPlanEvent(parseInt(b)-1)):(g.comboboxInitEvent(),$(".roomsdiv a").off("click"),$(".roomsdiv a").addClass("off").removeClass("Jcursor")))}),g.closeDropBoxEvent($(".housediv div"),$(".housediv ul"))},roomPlanEvent:function(a){var c=this;$(".roomsdiv a").off().on("click",function(){var d,e=$(this),f=0,g=0;if(e.hasClass("sub-btn")){if(d=parseInt(e.siblings("span").find("input").val())-1,-1==d)return;c.roomsPlanStatusEvent(e.parent().attr("id"),d,e.siblings("span").attr("data-en"),e.siblings("span").attr("data-nj"),e.siblings("span").attr("data-tag")),e.siblings("a").removeClass("off"),$(".add-btn").removeClass("off").addClass("Jcursor"),$(this).siblings("span").find("input").val(d),0==d&&(e.addClass("off").removeClass("Jcursor"),c.initThisObjContentStrEvent(e.parent().attr("id")))}else{if(d=parseInt(e.siblings("span").find("input").val())+1,$.each(b,function(a,b){g+=parseInt(b.count)}),d==a+1||g==a)return;c.roomsPlanStatusEvent(e.parent().attr("id"),d,e.siblings("span").attr("data-en"),e.siblings("span").attr("data-nj"),e.siblings("span").attr("data-tag")),e.siblings("a").removeClass("off").addClass("Jcursor"),$(this).siblings("span").find("input").val(d),$.each(b,function(a,b){f+=parseInt(b.count)}),(d==a||f==a)&&(e.addClass("off").removeClass("Jcursor"),$(".add-btn").addClass("off").removeClass("Jcursor"))}c.roomOperationEvent()})},roomsPlanStatusEvent:function(a,c,d,e,f){var g=a,h=c,i=d,j=e,k=f;b[g]={count:h,name:i,cname:j,tag:k}},roomOperationEvent:function(){var a;$.each(b,function(b,c){$(".mainarea_list li").hasClass("house"+c.tag)?0==parseInt(c.count)&&$(".mainarea_list li.house"+c.tag).remove():0!=parseInt(c.count)&&(a='<li class="house'+c.tag+' scd">\t<label for="'+c.name+'Radio" id="Checkbox'+c.tag+'" class="Jcursor">\t<input type="checkbox" class="I'+b+" J"+c.name+' sccc display" data-sw="0" data-type="'+c.name+'" data-name="'+c.cname+'"  id="'+c.name+'Radio">\t<s class="J'+b+' scb"></s> \t<div class="room'+c.tag+'"> \t<em></em> <dl>'+c.cname+'</dl> \t</div></label><span class="already_choose none"></span></li> ',$(".mainarea_list").append(a))})},selectRoomTechnologyEvent:function(){var a=this;$(document).on("click","#zwRadio,#cwRadio,#fmfRadio,#ymjRadio,#etfRadio,#sfRadio,#kctRadio,#ytRadio,#cfRadio",function(){var b,d,e,f,g=$(this);b=g.attr("data-sw"),d=g.data("type"),e=g.data("name"),$.each($(".mainareadiv input[type='checkbox']"),function(a,b){0==parseInt($(b).attr("data-sw"))&&($(b).siblings("s").removeClass("rep_craft_check"),$(b).closest("li").children("span").addClass("none").empty())}),0==parseInt(b)?(g.siblings("s").addClass("rep_craft_check"),g.closest("li").children("span").removeClass("none").html(c)):1==parseInt(b)&&(f=JSON.parse(g.attr("data-option"))),a.contentStrEvent(d,e,f)})},comboboxInitEvent:function(){var a=this;$(".roomsdiv input").val(0),$(".roomsdiv a.sub-btn").addClass("off").removeClass("Jcursor"),$(".scc").removeClass("can_not_check rep_craft_check"),$(".scb").removeClass("rep_craft_check").addClass("can_not_check"),$(".mainareadiv li").find("span").addClass("none").removeClass("Jcol").empty(),$(".mainareadiv li").find("input").attr("data-sw",0),$(".mainareadiv li").find("input").attr("data-option",""),$(".mainareadiv li").find("input").attr("checked",!1),$(".mainareadiv li").find("input.sccc").attr("disabled","disabled"),$(".mainareadiv li").find("input.sccc").parent("label").removeClass("Jcursor"),$(".mainareadiv li.scd").remove(),a.initcontentStrEvent(),b={}},closeDropBoxEvent:function(a,b){var c=a,d=b;$(document).on("click",function(){c.hasClass("item_hover_180")&&c.removeClass("item_hover_180"),d.slideUp()})},changeTitleEvent:function(a){var b;switch(a){case 1:b="您只有一间主卧&nbsp&nbsp请<span style='color:#f60'>跳过第二步继续填写下面的内容</span>";break;case 2:b="除了主卧以外其余<span style='color:#f60'>一间</span>房间怎么安排";break;case 3:b="除了主卧以外其余<span style='color:#f60'>两间</span>房间怎么安排";break;case 4:b="除了主卧以外其余<span style='color:#f60'>三间</span>房间怎么安排"}return b},contentStrEvent:function(a,b,c){var d,e;null!=c&&void 0!=c&&(e=c[a]),d='<i class="title">房间类型：<em class="JroomName" data-rn="'+a+'">'+b+'</em></i> <div class="filter_mod"> <div class="filter_item"><label class="item_title" data-name="ground">地面处理方式：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||"smdb"==e.ground?"cit":"")+'" rel="nofollow" data-val="smdb">实木地板</a> <a class="'+(null!=e&&void 0!=e&&"qhfhdb"==e.ground?"cit":"")+'" rel="nofollow" data-val="qhfhdb">强化复合地板</a><a class="'+(null!=e&&void 0!=e&&"cz"==e.ground?"cit":"")+'" rel="nofollow" data-val="cz">铺设瓷砖</a></div></div> ',("zw"==a||"ymj"==a||"cw"==a||"etf"==a||"fmf"==a)&&(d+='<div class="filter_item"><label class="item_title" data-name="wardrobe" >衣柜制作方式：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.wardrobe?"cit":"")+'" rel="nofollow" data-val="true" >木工制作衣柜</a> <a class="'+(null!=e&&void 0!=e&&0==e.wardrobe?"cit":"")+'" rel="nofollow" data-val="false" >自行购买衣柜</a></div></div> '),("zw"==a||"cw"==a||"etf"==a||"fmf"==a||"ymj"==a||"sf"==a||"kct"==a)&&(d+='<div class="filter_item"><label class="item_title" data-name="ceiling" >木工制作吊顶：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.ceiling?"cit":"")+'" rel="nofollow" data-val="true" >需要</a>\t <a class="'+(null!=e&&void 0!=e&&0==e.ceiling?"cit":"")+'" rel="nofollow" data-val="false" >不需要</a></div></div> <div class="filter_item"><label class="item_title" data-name="wallpaper" >墙面铺贴墙纸：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.wallpaper?"cit":"")+'" rel="nofollow" data-val="true" >需要</a>\t <a class="'+(null!=e&&void 0!=e&&0==e.wallpaper?"cit":"")+'" rel="nofollow" data-val="false" >不需要</a></div></div> '),("zw"==a||"cw"==a||"etf"==a||"fmf"==a||"ymj"==a||"sf"==a)&&(d+='<div class="filter_item"><label class="item_title" data-name="window" >有无飘窗结构：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.window?"cit":"")+'" rel="nofollow" data-val="true" >有飘窗</a> <a class="'+(null!=e&&void 0!=e&&0==e.window?"cit":"")+'" rel="nofollow" data-val="false" >没有飘窗</a></div></div> '),("etf"==a||"sf"==a)&&(d+='<div class="filter_item"><label class="item_title" data-name="tatami" >榻榻米的制作：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.tatami?"cit":"")+'" rel="nofollow" data-val="true" >木工制作榻榻米</a> <a class="'+(null!=e&&void 0!=e&&0==e.tatami?"cit":"")+'" rel="nofollow" data-val="false" >自行购买榻榻米</a></div></div> '),"sf"==a&&(d+='<div class="filter_item"><label class="item_title" data-name="bookcase" >书桌书柜选择：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.bookcase?"cit":"")+'" rel="nofollow" data-val="true" >木工制作简易书桌书柜</a> <a class="'+(null!=e&&void 0!=e&&0==e.bookcase?"cit":"")+'" rel="nofollow" data-val="false" >购买成品书桌书柜</a></div></div> '),"etf"==a&&(d+='<div class="filter_item"><label class="item_title" data-name="desk" >书桌书架选择：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.desk?"cit":"")+'" rel="nofollow" data-val="true" >木工制作简易书桌书架</a> <a class="'+(null!=e&&void 0!=e&&0==e.desk?"cit":"")+'" rel="nofollow" data-val="false" >购买成品书桌书架</a></div></div> '),"kct"==a&&(d+='<div class="filter_item"><label class="item_title" data-name="shoebox" >鞋柜制作方式：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.shoebox?"cit":"")+'" rel="nofollow" data-val="true" >木工制作鞋柜</a> <a class="'+(null!=e&&void 0!=e&&0==e.shoebox?"cit":"")+'" rel="nofollow" data-val="false" >自行购买鞋柜</a></div></div> <div class="filter_item"><label class="item_title" data-name="wine_cabinet" >酒柜制作方式：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.wine_cabinet?"cit":"")+'" rel="nofollow" data-val="true" >木工制作酒柜</a> <a class="'+(null!=e&&void 0!=e&&0==e.wine_cabinet?"cit":"")+'" rel="nofollow" data-val="false" >自行购买酒柜</a></div></div> '),"yt"==a&&(d+='<div class="filter_item"><label class="item_title" data-name="hanging_cabinet" >木工制作吊柜：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.hanging_cabinet?"cit":"")+'" rel="nofollow" data-val="true" >需要</a> <a class="'+(null!=e&&void 0!=e&&0==e.hanging_cabinet?"cit":"")+'" rel="nofollow" data-val="false" >不需要</a></div></div> '),"cf"==a&&(d+='<div class="filter_item"><label class="item_title" data-name="cupboard" >木工制作橱柜：</label> <div class="item_mod"><a class="'+(null==e||void 0==e||1==e.cupboard?"cit":"")+'" rel="nofollow" data-val="true" >需要</a> <a class="'+(null!=e&&void 0!=e&&0==e.cupboard?"cit":"")+'" rel="nofollow" data-val="false" >不需要</a></div></div> '),d+='</div><div class="savediv"><input type="button" class="saveBtn J_btnR" value="保存工艺"></div> ',$(".mainareadiv .filter_nav ").html(d)},initThisObjContentStrEvent:function(a){var b,c=$(".I"+a).data("type"),d=$(".JroomName").data("rn");null!=c&&void 0!=c&&null!=d&&void 0!=d&&c==d&&(b='<div class="prompt"><i>&nbsp;</i><span>请先选择左边的房间</span></div>',$(".mainareadiv .filter_nav ").html(b))},initcontentStrEvent:function(){var a;a='<div class="prompt"><i>&nbsp;</i><span>请先选择左边的房间</span></div>',$(".mainareadiv .filter_nav ").html(a)},roomConfigureSelectEvent:function(){$(document).on("click",".filter_item a",function(){$(this).addClass("cit").siblings().removeClass("cit")}),$(document).off("click",".J_btnR").on("click",".J_btnR",function(){var a,b=$(this).closest("div.filter_nav"),c={},e={};a=b.find(".JroomName").data("rn"),$.each(b.find(".filter_item"),function(a,b){c[$(b).find("label").data("name")]=$(b).find("div.item_mod a.cit").data("val")}),e[a]=c,$(".J"+a).attr("data-option",JSON.stringify(e)),$(".J"+a).attr("data-sw",1),$(".J"+a).closest("li").children("span").addClass("Jcol").removeClass("none").html(d)})},lastdivClickEvent:function(){$(document).on("click",".lastdiv input[type='checkbox']",function(){var a=$(this);a.is(":checked")?(a.siblings("s").addClass("rep_craft_check"),a.attr("data-select","1")):(a.siblings("s").removeClass("rep_craft_check"),a.attr("data-select","0"))})},sumbitCalEvent:function(){var a=this;$(document).off("click",".nowcal").on("click",".nowcal",function(){var c={},d={},f={},g=0,h=0,i="";c.city=$("#Jcity").text()+"市",c.area=$("#c_area").val(),c.room_num=$(".room span").text(),c.parlor_num=$(".parlor span").text(),c.bathroom_num=$(".bathroom span").text(),c.balcony_num=$(".balcony span").text(),d.master=1,d.second=$(".Jsecond").val(),d.child=$(".Jchild").val(),d.parent=$(".Jparent").val(),d.cloakroom=$(".Jcloakroom").val(),d.study=$(".Jstudy").val(),c.room_distribution=d,c.master_distribution=a.initGetCalDataEvent($(".Jzw")),c.second_distribution=a.initGetCalDataEvent($(".Jcw")),c.child_distribution=a.initGetCalDataEvent($(".Jetf")),c.parent_distribution=a.initGetCalDataEvent($(".Jfmf")),c.cloakroom_distribution=a.initGetCalDataEvent($(".Jymj")),c.study_distribution=a.initGetCalDataEvent($(".Jsf")),c.parlor_distribution=a.initGetCalDataEvent($(".Jkct")),c.balcony_distribution=a.initGetCalDataEvent($(".Jyt")),c.kitchen_distribution=a.initGetCalDataEvent($(".Jcf")),f=a.initGetFloorDataEvent($(".othersdiv .filter_item")),0==f.isElevator?c.floor=f.isElevator:-1==f.isElevator&&(c.floor=f.floor),c.wall=$("#qtccgcRadio").attr("data-select"),c.ground_sank=$("#wsjdmxcRadio").attr("data-select");var j=$(".Jzw").attr("data-sw"),k=$(".Jkct").attr("data-sw"),l=$(".Jyt").attr("data-sw"),m=$(".Jcf").attr("data-sw"),n=!0;$.each(b,function(a,b){"0"!=b.count&&"0"==$(".I"+a).attr("data-sw")&&(n=!1),g+=b.count}),h=parseInt($(".room").find("span").text())-1-g,""==$("#c_area").val()?layer.msg("建筑面积还没有填哦~~"):h>0?layer.msg("您还有"+h+"间房间没有安排"):"0"==j?layer.msg("主卧还没有保存工艺哦~~"):"0"==k?layer.msg("客餐厅还没有保存工艺哦~~"):"0"==l?layer.msg("阳台还没有保存工艺哦~~"):"0"==m?layer.msg("厨房还没有保存工艺哦~~"):n?$.ajax({url:e,type:"GET",async:!0,dataType:"jsonp",data:{calculator_json:JSON.stringify(c)},beforeSend:function(){$("#loading").removeClass("display")},success:function(a){if("000"==a.code){var b={};b.gzrg=a.data.gzrg,b.sdrg=a.data.sdrg,b.wgrg=a.data.wgrg,b.mgrg=a.data.mgrg,b.yqgrg=a.data.yqgrg,b.zgrg=a.data.zgrg,b.rgzj=a.data.rgzj,b.zdsdcl=a.data.zdsdcl,b.gdsdcl=a.data.gdsdcl,b.wgfc=a.data.wgfc,b.mgfc=a.data.mgfc,b.yqcl=a.data.yqcl,b.czdd=a.data.czdd,b.czgd=a.data.czgd,b.bc=a.data.bc,b.dls=a.data.dls,b.db=a.data.db,b.mm=a.data.mm,b.cfym=a.data.cfym,b.lyfym=a.data.lyfym,b.ygym=a.data.ygym,b.jcdd=a.data.jcdd,b.cgsys=a.data.cgsys,b.zxzj=a.data.zxzj,sessionStorage.payJson=JSON.stringify(b);var d="calresult.html#/calresult";window.location.href=d+"?cs="+c.city+"&mj="+c.area+"&fj="+c.room_num+"&kt="+c.parlor_num+"&wsj="+c.bathroom_num+"&yt="+c.balcony_num}else 200==a.code&&layer.alert(a.msg)},complete:function(){$("#loading").addClass("display")},error:function(){}}):($.each(b,function(a,b){"0"!=b.count&&"0"==$(".I"+a).attr("data-sw")&&(i+=b.cname+",")}),i=i.substring(0,i.lastIndexOf(",")),layer.msg(i+"还没有保存工艺"))})},initGetCalDataEvent:function(a){var b,c={},d=a.attr("data-sw"),e=a.data("type");return null!=d&&void 0!=d&&0!=parseInt(d)&&(b=JSON.parse(a.attr("data-option")),c=b[e]),c},initGetFloorDataEvent:function(a){var b={};return $.each(a,function(a,c){b[$(c).find("label").data("name")]=$(c).find("div.item_mod a.cit").data("val")}),b}};a.indexCalWrapHandler=function(){f.init()}}()});