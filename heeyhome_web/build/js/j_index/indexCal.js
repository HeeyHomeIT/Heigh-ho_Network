/*! Pc.Heigh-ho.Renovation-1.0.0.js 2017-01-22 */
define(["app"],function(a){!function(){var b={},c={},d="http://www.heeyhome.com/api/public/costcalculator/count",e={init:function(){var a=this;a.areaInputChangeEvent(),a.sumbitCalEvent()},areaInputChangeEvent:function(){var a=this;$(".c_area").on({focus:function(){var a=$(this),b=a.attr("attr-placeholder");a.val()==b&&a.val(""),$(".areadiv").children("label").removeClass("whether").parent(".areadiv").removeClass("itemClickError")},blur:function(){var b,c=$(this),d=c.attr("attr-placeholder");""==c.val()&&c.val(d),b=a.errorMsgEvent(c.val()),"true"!=b?($(".areadiv").children("label").text(b).addClass("whether").parent(".areadiv").addClass("itemClickError"),a.flowStatusEvent($(".cal1").data("type"),0)):(a.flowStatusEvent($(".cal1").data("type"),1),a.styleAddOrRemoveEvent($(".housediv"),1),$(".housediv div").off("click"),$(".housediv ul").off(),a.houseSelectEvent())}})},houseSelectEvent:function(){var a,b,c=this;$(".housediv div").on("click",function(a){a.stopPropagation(),c.triangleArrowChangeEvent($(this),0)}),$(".housediv ul").delegate("li","click",function(){b=$(this).text(),$(this).parent().prev().text(b),$(this).parent().parent().hasClass("room")&&(a=c.changeTitleEvent(parseInt(b)),$(".cal2 p").addClass("col_eec988").html(a),c.comboboxInitEvent($(".roomsdiv div"),$(".roomsdiv ul"),$(".s4,.s5")),1==parseInt(b)?(c.styleAddOrRemoveEvent($(".roomsdiv"),0),c.flowStatusEvent($(".cal2").data("type"),1),$(".roomsdiv div").off("click"),$(".roomsdiv ul").off(),$(".mainarea_list li a").off("click"),c.styleAddOrRemoveEvent($(".cal3"),2),c.flowStatusEvent($(".cal3").data("type"),1),c.roommainlyEvent()):(c.styleAddOrRemoveEvent($(".roomsdiv"),1),c.flowStatusEvent($(".cal2").data("type"),0),c.flowStatusEvent($(".cal3").data("type"),0),$(".roomsdiv div").off("click"),$(".roomsdiv ul").off(),c.roomPlanEvent(parseInt(b)-1)))}),c.closeDropBoxEvent($(".housediv div"),$(".housediv ul"),0)},roomPlanEvent:function(a){var b=this,c=!1;b.appendLiStrEvent($(".roomsdiv div"),$(".roomsdiv ul"),a),$(".roomsdiv div").on("click",function(d){d.stopPropagation(),b.styleAddOrRemoveEvent($(".cal3"),2),b.triangleArrowChangeEvent($(this),0),($(this).hasClass("s4")||$(this).hasClass("s5"))&&($(this).hasClass("clickselect")?($(this).removeClass("clickselect"),$(this).attr("data-select",0)):($(this).addClass("clickselect"),$(this).attr("data-select",1)),c=!0,$(".roomsdiv").children("label").removeClass("whether"),b.roomsPlanStatusEvent($(this).data("name"),$(this).attr("id"),parseInt($(this).attr("data-select")),$(this).data("info"))),$(".roomsdiv").children("label").removeClass("whether"),b.roomOperationEvent(c,a,$(this)),c=!1}),$(".roomsdiv ul").delegate("li","click",function(){c=!0,num=$(this).text(),$(this).parent().siblings().find("em").text(num),b.roomsPlanStatusEvent($(this).parent().parent().data("name"),$(this).parent().parent().attr("id"),parseInt(num),$(this).parent().parent().data("info"))}),b.closeDropBoxEvent($(".roomsdiv div"),$(".roomsdiv ul"),0)},roomOperationEvent:function(a,b,d){var e=this,f=0;a&&(console.log("roomsPlanStatusEvent: "),console.log(c),$.each(c,function(a){f+=parseInt(c[a].count)}),f==b?($(".roomsdiv div").addClass("okhover"),$(".roomsdiv").removeClass("col_eec988").children("div").removeClass("col_eec988").removeClass("border_eec988").removeClass("after_eec988 "),$.each(c,function(a){0!=c[a].count&&$("#"+c[a].roomId).addClass("col_eec988").addClass("border_eec988").addClass("after_eec988 ")}),d.hasClass("s4")||d.hasClass("s5")||d.attr("data-select",parseInt(d.find("em").text()))):b>f?($(".roomsdiv div").removeClass("okhover"),b>f&&$(".roomsdiv").addClass("col_eec988").children("div").addClass("col_eec988").addClass("border_eec988").addClass("after_eec988 "),d.hasClass("s4")||d.hasClass("s5")||d.attr("data-select",parseInt(d.find("em").text()))):f>b&&($(".roomsdiv").children("label").text("最多只能安排"+b+"个房间").addClass("whether"),$(".roomsdiv div").addClass("okhover"),d.hasClass("s4")||d.hasClass("s5")?d.hasClass("clickselect")&&(d.removeClass("clickselect"),d.attr("data-select",0)):d.find("em").text(parseInt(d.attr("data-select"))),$.each(c,function(a){c[a].roomId==d.attr("id")&&(c[a].count=parseInt(d.attr("data-select")))})),e.contentStrEvent(c))},errorMsgEvent:function(a){var b=70,c=160,d="";return d=b>a||a>c?"小于70㎡或大于160㎡请咨询客服":"true"},styleAddOrRemoveEvent:function(a,b){var c=a,d=b;1==d?c.addClass("col_eec988").children("div").addClass("col_eec988").addClass("border_eec988").addClass("after_eec988 ").css("cursor","pointer"):0==d?c.removeClass("col_eec988").children("div").removeClass("col_eec988").removeClass("border_eec988").removeClass("after_eec988 ").css("cursor","not-allowed"):2==d||3==d||6==d?(console.log(c),c.addClass("col_eec988").find("dl").addClass("col_eec988").addClass("after_eec988 "),c.find("em").addClass("clickit"),2==d?$(".mainarea_list").css("cursor","pointer"):3==d?$(".otherroom_list").css("cursor","pointer"):6==d&&$(".other_list").css("cursor","pointer")):(4==d||5==d||7==d)&&(c.removeClass("col_eec988").find("dl").removeClass("col_eec988").removeClass("after_eec988 "),c.find("em").removeClass("clickit"),4==d?$(".mainarea_list").css("cursor","not-allowed"):5==d?$(".otherroom_list").css("cursor","not-allowed"):7==d&&$(".other_list").css("cursor","not-allowed"))},changeTitleEvent:function(a){var b;switch(a){case 1:b="您只有一间主卧&nbsp&nbsp请继续往下填写";break;case 2:b="除了主卧以外其余一间房间怎么安排";break;case 3:b="除了主卧以外其余两间房间怎么安排";break;case 4:b="除了主卧以外其余三间房间怎么安排"}return b},triangleArrowChangeEvent:function(a,b){var c=a;c.hasClass("item_hover_180")?c.removeClass("item_hover_180"):c.addClass("item_hover_180"),0==b?(c.find("ul").slideToggle("300"),c.siblings().removeClass("item_hover_180").find("ul").slideUp("300")):1==b&&(c.parent().parent().children("div").toggle(),c.parent().parent().siblings().find("dl").removeClass("item_hover_180"),c.parent().parent().siblings().find("div.filter_nav").hide())},flowStatusEvent:function(a,c){var d=a,e=c;b[d]={status:e}},roomsPlanStatusEvent:function(a,b,d,e){var f=a,g=b,h=d,i=e;c[f]={roomId:g,count:h,info:i}},closeDropBoxEvent:function(a,b,c){var d=a,e=b;$(document).on("click",function(){d.hasClass("item_hover_180")&&d.removeClass("item_hover_180"),0==c?e.slideUp("300"):1==c&&e.hide()})},appendLiStrEvent:function(a,b,c){var d="";b.removeClass("clearli"),a.find("li").remove();for(var e=0;c>=e;e++)d+="<li>"+e+"</li>";a.find("ul").append(d)},comboboxInitEvent:function(a,b,d){var e=this;b.slideUp("300"),b.addClass("clearli").find("li").remove(),(a.hasClass("item_hover_180")||a.hasClass("clickselect"))&&a.removeClass("item_hover_180"),a.find("em").text(0),d.removeClass("clickselect"),a.attr("data-select",0),$.each(c,function(a){$(".mainarea_list li.room"+c[a].info.ln).remove()}),e.styleAddOrRemoveEvent($(".cal3"),4),e.styleAddOrRemoveEvent($(".cal4"),5),e.styleAddOrRemoveEvent($(".cal5"),7),$(".roomsdiv").children("label").removeClass("whether").text(""),$(".mainarea_list li a").off("click"),$(".otherroom_list li a").off("click"),$(".other_list li a").off("click"),$(".mainarea_list li a").find("dl").removeClass("item_hover_180"),$(".otherroom_list li a").find("dl").removeClass("item_hover_180"),$(".other_list li a").find("dl").removeClass("item_hover_180"),$(".other_list li a").removeClass("clickselect"),$(".mainarea_list li").find("div.filter_nav").hide(),$(".otherroom_list li").find("div.filter_nav").hide(),$(".other_list li").find("div.filter_nav").hide(),$(".cal6 input").removeClass("col_eec988").removeClass("border_eec988").css("cursor","not-allowed"),$(".roomsdiv div").removeClass("okhover"),c={}},contentStrEvent:function(a){var b,c=this;$.each(a,function(c){$(".mainarea_list li.room"+a[c].info.ln).remove(),0!=a[c].count&&(b='<li class="room'+a[c].info.ln+'">\t\t<a class="item'+a[c].info.ln+'"> \t\t\t<em></em> \t\t\t<dl class="item_hover_0 col_eec988 after_eec988">'+a[c].info.cname+'</dl> \t\t</a> \t\t<div class="filter_nav '+a[c].info.cstyle+' display"> \t\t\t<i></i> \t\t\t<div class="filter_mod"> \t\t\t\t<div class="filter_item"> \t\t\t\t\t<label class="item_title" data-name="ground" >地面处理方式：</label> \t\t\t\t\t<div class="item_mod"> \t\t\t\t\t\t<a class="cit" rel="nofollow" data-val="smdb" >实木地板</a> \t\t\t\t\t\t<a rel="nofollow" data-val="qhfhdb" >强化复合地板</a> \t\t\t\t\t\t<a rel="nofollow" data-val="cz" >铺设瓷砖</a> \t\t\t\t\t</div> \t\t\t\t</div> ',("ymj"==c||"cw"==c||"etf"==c||"fmf"==c)&&(b+='\t\t<div class="filter_item"> \t\t\t\t<label class="item_title" data-name="wardrobe" >衣柜制作方式：</label> \t\t\t\t<div class="item_mod"> \t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >木工制作衣柜</a> \t\t\t\t\t<a rel="nofollow" data-val="false" >自行购买衣柜</a> \t\t\t\t</div> \t\t\t</div> '),b+='\t\t\t<div class="filter_item"> \t\t\t\t\t<label class="item_title" data-name="ceiling" >木工制作吊顶：</label> \t\t\t\t\t<div class="item_mod"> \t\t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >需要</a> \t\t\t\t\t\t<a rel="nofollow" data-val="false" >不需要</a> \t\t\t\t\t</div>\t\t\t\t\t</div> \t\t\t\t<div class="filter_item"> \t\t\t\t\t<label class="item_title" data-name="wallpaper" >墙面铺贴墙纸：</label> \t\t\t\t\t<div class="item_mod"> \t\t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >需要</a> \t\t\t\t\t\t<a rel="nofollow" data-val="false" >不需要</a> \t\t\t\t\t</div>\t\t\t\t\t</div> \t\t\t\t<div class="filter_item"> \t\t\t\t\t<label class="item_title" data-name="window" >有无飘窗结构：</label> \t\t\t\t\t<div class="item_mod"> \t\t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >有飘窗</a> \t\t\t\t\t\t<a rel="nofollow" data-val="false" >没有飘窗</a> \t\t\t\t\t</div>\t\t\t\t\t</div> ',("sf"==c||"etf"==c)&&(b+='\t\t<div class="filter_item"> \t\t\t\t<label class="item_title" data-name="tatami" >榻榻米的制作：</label> \t\t\t\t<div class="item_mod"> \t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >木工制作榻榻米</a> \t\t\t\t\t<a rel="nofollow" data-val="false" >自行购买榻榻米</a> \t\t\t\t</div> \t\t\t</div> '),"sf"==c&&(b+='\t\t<div class="filter_item"> \t\t\t\t<label class="item_title" data-name="bookcase" >书桌书柜选择：</label> \t\t\t\t<div class="item_mod"> \t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >木工制作简易书桌书柜</a> \t\t\t\t\t<a rel="nofollow" data-val="false" >购买成品书桌书柜</a> \t\t\t\t</div> \t\t\t</div> '),"etf"==c&&(b+='\t\t<div class="filter_item"> \t\t\t\t<label class="item_title" data-name="desk" >书桌书架选择：</label> \t\t\t\t<div class="item_mod"> \t\t\t\t\t<a class="cit" rel="nofollow" data-val="true" >木工制作简易书桌书架</a> \t\t\t\t\t<a rel="nofollow" data-val="false" >购买成品书桌书架</a> \t\t\t\t</div> \t\t\t</div> '),b+="\t\t</div> \t\t</div> \t</li> ",$(".mainarea_list").append(b))}),$(".mainarea_list li a").off("click"),c.roommainlyEvent()},roommainlyEvent:function(){var a=this;$(".mainarea_list li a").on("click",function(b){b.stopPropagation(),a.triangleArrowChangeEvent($(this).find("dl"),1),a.styleAddOrRemoveEvent($(".cal4"),3),$(".otherroom_list li a").off("click"),a.otherSelectEvent()}),a.roomConfigureSelectEvent(),a.closeDropBoxEvent($(".mainarea_list li a dl"),$(".mainarea_list li>div"),1)},otherSelectEvent:function(){var a=this;$(".otherroom_list li a").on("click",function(b){b.stopPropagation(),a.triangleArrowChangeEvent($(this).find("dl"),1),a.styleAddOrRemoveEvent($(".cal5"),6),$(".other_list li a").off("click"),a.houseCharacteristicEvent()}),a.roomConfigureSelectEvent(),a.closeDropBoxEvent($(".otherroom_list li a dl"),$(".otherroom_list li>div"),1)},houseCharacteristicEvent:function(){var a=this;$(".other_list li a").on("click",function(b){b.stopPropagation(),a.triangleArrowChangeEvent($(this).find("dl"),1),$(this).hasClass("otherclick")&&($(this).hasClass("clickselect")?($(this).removeClass("clickselect"),$(this).attr("data-select","true")):($(this).addClass("clickselect"),$(this).attr("data-select","false"))),a.styleAddOrRemoveEvent($(".cal5"),6),$(".cal6 input").addClass("col_eec988").addClass("border_eec988").css("cursor","pointer")}),a.roomConfigureSelectEvent(),a.closeDropBoxEvent($(".other_list li a dl"),$(".other_list li>div"),1)},roomConfigureSelectEvent:function(){$(".filter_item a").on("click",function(){$(this).addClass("cit").siblings().removeClass("cit")}),$(".filter_nav i").on("click",function(){$(this).parents(".filter_nav").hide();var a=$(this).parents(".filter_nav").siblings().find("dl");a.hasClass("item_hover_180")&&a.removeClass("item_hover_180")})},sumbitCalEvent:function(){var a=this;$(document).on("click",".nowcal",function(){if($(this).hasClass("border_eec988")&&$(this).hasClass("col_eec988")){var b={},c={},e={};b.city=$("#nowCity label").text()+"市",b.area=$("#c_area").val(),b.room_num=$(".room span").text(),b.parlor_num=$(".parlor span").text(),b.bathroom_num=$(".bathroom span").text(),b.balcony_num=$(".balcony span").text(),c.master=1,c.second=$("#s1").data("select"),c.child=$("#s2").data("select"),c.parent=$("#s3").data("select"),c.cloakroom=$("#s4").data("select"),c.study=$("#s5").data("select"),b.room_distribution=c,b.master_distribution=a.initGetCalDataEvent($(".room0 .filter_item")),0!=$("#s1").data("select")&&(b.second_distribution=a.initGetCalDataEvent($(".room1 .filter_item"))),0!=$("#s2").data("select")&&(b.child_distribution=a.initGetCalDataEvent($(".room2 .filter_item"))),0!=$("#s3").data("select")&&(b.parent_distribution=a.initGetCalDataEvent($(".room3 .filter_item"))),0!=$("#s4").data("select")&&(b.cloakroom_distribution=a.initGetCalDataEvent($(".room4 .filter_item"))),0!=$("#s5").data("select")&&(b.study_distribution=a.initGetCalDataEvent($(".room5 .filter_item"))),b.parlor_distribution=a.initGetCalDataEvent($(".otherroom0 .filter_item")),b.balcony_distribution=a.initGetCalDataEvent($(".otherroom1 .filter_item")),b.kitchen_distribution=a.initGetCalDataEvent($(".otherroom2 .filter_item")),e=a.initGetCalDataEvent($(".other0 .filter_item")),0==e.isElevator?b.floor=e.isElevator:-1==e.isElevator&&(b.floor=e.floor),b.wall=$("#other1").attr("data-select"),b.ground_sank=$("#other2").attr("data-select"),console.log(b),console.log(JSON.stringify(b)),$.ajax({url:d,type:"GET",async:!0,dataType:"jsonp",data:{calculator_json:JSON.stringify(b)},success:function(a){console.log(a);var c={};c.gzrg=a.data.gzrg,c.sdrg=a.data.sdrg,c.wgrg=a.data.wgrg,c.mgrg=a.data.mgrg,c.yqgrg=a.data.yqgrg,c.zgrg=a.data.zgrg,c.rgzj=a.data.rgzj,c.zdsdcl=a.data.zdsdcl,c.gdsdcl=a.data.gdsdcl,c.wgfc=a.data.wgfc,c.mgfc=a.data.mgfc,c.yqcl=a.data.yqcl,c.czdd=a.data.czdd,c.czgd=a.data.czgd,c.bc=a.data.bc,c.dls=a.data.dls,c.db=a.data.db,c.mm=a.data.mm,c.cfym=a.data.cfym,c.lyfym=a.data.lyfym,c.ygym=a.data.ygym,c.jcdd=a.data.jcdd,c.cgsys=a.data.cgsys,c.zxzj=a.data.zxzj,sessionStorage.payJson=JSON.stringify(c);var d="calresult.html#/calresult";window.location.href=d+"?cs="+b.city+"&mj="+b.area+"&fj="+b.room_num+"&kt="+b.parlor_num+"&wsj="+b.bathroom_num+"&yt="+b.balcony_num},error:function(){}})}})},initGetCalDataEvent:function(a){var b={};return $.each(a,function(a,c){b[$(c).find("label").data("name")]=$(c).find("div.item_mod a.cit").data("val")}),b}};a.indexCalWrapHandler=function(){e.init()}}()});