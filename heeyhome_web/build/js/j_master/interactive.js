/*! Pc.Heigh-ho.Renovation-1.0.0.js 2017-01-22 */
!function(){var a,b,c,d,e,f,g,h=angular.module("heeyhomeApp"),i="http://www.heeyhome.com/api/public/",j=i+"personal/foremaninfo?callback=JSON_CALLBACK",k=i+"personal/portrait/change",l=i+"personal/safe",m=i+"myworkers",n=i+"myworkers/workerinfo",o=i+"myworkers/changeworker",p=i+"myworkers/addworker",q=i+"myworkers/pricelist",r=i+"withdraw/apply",s=i+"mywallet/bill",t=i+"mywallet",u=i+"mywallet/bill/del",v=i+"personal/myshop?callback=JSON_CALLBACK",w=i+"personal/myshop/uploadimg",x=i+"personal/myshop/addtechnics",y=i+"personal/myshop/editechnics",z=i+"myworkcase?callback=JSON_CALLBACK",A=i+"addmyworkcase",B=i+"delmyworkcase",C=i+"bankcard/getname?callback=JSON_CALLBACK",D=i+"bankcard/getcardtype?callback=JSON_CALLBACK",E=i+"bankcard/cardverify?callback=JSON_CALLBACK",F=i+"mybankcards?callback=JSON_CALLBACK",G=i+"sendsms",H=i+"personal/myshop/stylelist?callback=JSON_CALLBACK",I=i+"personal/myshop/change",J=i+"personal/myshop/deltechnics",K=i+"personal/myshop/del",L=i+"personal/foremaninfo/change",M=i+"personal/message",N=i+"personal/message/del",O=i+"personal/message/read",P=i+"personal/message/readall",Q=i+"personal/message/isnew",R=i+"order/shop/list",S=i+"order/process/startWork",T=i+"order/process/lookWork",U=i+"order/shop/listfilter",V=i+"order/shop/subupdatemsg",W=i+"order/aeckonandactual/adddate",X=i+"order/aeckonandactual/generatelist",Y=i+"order/aeckonandactual/getlistname?callback=JSON_CALLBACK",Z=i+"order/aeckonandactual/getlistdata?callback=JSON_CALLBACK",_=i+"order/aeckonandactual/update?callback=JSON_CALLBACK",aa=i+"order/aeckonandactual/selstatus",ba=i+"materialslist",ca=i+"order/shop/list",da=i+"order/style/addhousestyle",ea=i+"order/material/produce",fa=0,ga=0,ha='<div class="loading"><img src="image/icon-loading.gif"></div>',ia="建筑面积不能为空",ja="请选择有效的户型",ka="请选择装修风格",la="请选择合适的工期",ma="详细地址不能为空",na="施工图片不能为空",oa=$.cookie("userId");oa=null!=oa&&""!=oa&&void 0!=oa?$.base64.decode($.cookie("userId")):"";var pa=/^(((13[0-9]{1})|(14[0-9]{1})|(17[0]{1})|(15[0-3]{1})|(15[5-9]{1})|(18[0-9]{1}))+\d{8})$/,qa=/^\d{19}$/,ra={init:function(){ra.initEvent()},initEvent:function(){var a=this;a.initStyleChangeEvent(),a.initMHomeEvent(),a.initMDataEvent(),a.initMWorkEvent(),a.initMNewWorkEvent(),a.initMTeamEvent(),a.initMShopEvent(),a.initMOrderEvent(),a.initWithdrawEvent(),a.initOrderProcessEvent(),a.initBankEvent(),a.initBillEvent(),a.initMsgInfo(),a.initTeamDetailEvent(),a.initTeamInfoEvent(),a.initTeamEditEvent(),a.initMaterialEvent(),a.initSuccessCase()},initStyleChangeEvent:function(){h.controller("leftCtrl",["$scope","$http",function(){$(".left_ul li").click(function(){$(this).addClass("left_active").siblings().removeClass("left_active")});var a=window.location.hash,b=$("#left_ul a");b.each(function(){var b=$(this).attr("ui-sref");-1!=a.indexOf(b.replace(".","/"))&&$(this).parent().addClass("left_active")}),$.ajaxSetup({beforeSend:function(){$(".right_content_wrap").append(ha),$(".safe_right .loading").css("top","70%")},complete:function(){$(".right_content_wrap .loading").remove()}}),$.ajax({type:"get",url:Q,async:!0,dataType:"jsonp",data:{user_id:oa},success:function(a){null!=a&&"000"==a.code&&a.data.newmsgtotal>0&&$(".left_ul li").eq(7).append("<i>"+a.data.newmsgtotal+"</i>")},error:function(){}})}])},initMHomeEvent:function(){h.controller("mhomeCtrl",["$scope","$http",function(){$(".Jforeman").html("我的主页"),$(".left_ul li").eq(0).addClass("left_active").siblings().removeClass("left_active"),getHomeInfoHandler.getInfoEvent(),getHomeInfoHandler.getSafeEvent(),getHomeInfoHandler.getEmailEvent()}])},initMDataEvent:function(){h.controller("mDataCtrl",["$scope","$http",function(){$(".Jforeman").html("个人资料"),$(".left_ul li").eq(1).addClass("left_active").siblings().removeClass("left_active"),$('[data-toggle="distpicker"]').distpicker();for(var a=$("#works_content_title div"),b=0,c=0,d=document.getElementById("title_active"),e=0;e<a.length-1;e++)a[e].onclick=function(){startMoveHandler.startMoveEvent(d,this.offsetLeft,b,c),$(".personal_content").hide(),$(".update_head").hide(),$(".works_content >div:eq("+($(this).index()+1)+")").show().removeClass("hide")};getMasterInfoHandler.getInfoEvent(),uploadPictureHandler.uploadAvatar()}])},initMWorkEvent:function(){h.controller("mWorkCtrl",["$scope","$http",function(){$(".Jforeman").html("我的作品"),$(".left_ul li").eq(4).addClass("left_active").siblings().removeClass("left_active");for(var a=$("#works_content_title1 div"),b=0,c=0,d=document.getElementById("title_active"),e=0;e<a.length-1;e++)a[e].onclick=function(){startMoveHandler.startMoveEvent(d,this.offsetLeft,b,c),$(".works_complete_wrap").hide(),$(".works_pending_wrap").hide(),$(".my_work >div:eq("+($(this).index()+1)+")").show().removeClass("hide"),WUndonePageHandler.pageContentEvent(),WCompletePageHandler.pageContentEvent()};getWorkInfoHandler.workInfo()}])},initMNewWorkEvent:function(){h.controller("newworkCtrl",["$scope","$http",function(){new YMDselect("year1","month1","day1"),new YMDselect("year2","month2","day2"),$('[data-toggle="distpicker"]').distpicker(),$.ajax({type:"get",url:H,async:!0,dataType:"jsonp",success:function(a){if(null!=a&&"000"==a.code){var b='<div class="new_stylecnt">';$.each(a.data,function(a,c){b+="<span>"+c.stylename+"</span>"}),b+="</div>",$(".new_style").append(b),$(".new_stylecnt span").on("click",function(){$(this).toggleClass("active").siblings().removeClass("active")})}},error:function(){}}),addPicture.constructionPic(),$(".new_work_content .submit").on("click",function(){ajaxSubmit.confirmAdd()}),removeError.clickEvent()}])},initSuccessCase:function(){h.controller("success_caseCtrl",["$scope","$http",function(){$("#menuNavOuter").remove(),$("#headerWrapper").remove();var a=sessionStorage.getItem("case_id");$.ajax({type:"get",url:z,async:!0,dataType:"jsonp",data:{foreman_id:oa},success:function(b){null!=b&&"000"==b.code?$.each(b.data,function(b,c){if(c.case_id==a){$(".content_top h2 span").html(c.area),$(".content_top .include").html(c.housetype),$(".content_bottom .time").html(c.timelong),$(".content_bottom .address").html(c.address);var d="<ul>";$.each(c.img,function(a,b){d+='<li><img src="'+b.case_img+'"></li>'}),d+="</ul>",$(".bg_picture").append(d),superSlide.slidePic()}}):layer.msg(b.msg)},error:function(){}}),$.ajax({url:v,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){a&&"000"==a.code?$("#success_case .now_location .shopname").html(a.data.shop_name):layer.alert(a.msg)},error:function(){}})}])},initMTeamEvent:function(){h.controller("mTeamCtrl",["$scope","$http",function(){$(".Jforeman").html("我的团队"),$(".left_ul li").eq(5).addClass("left_active").siblings().removeClass("left_active"),getTeamInfoHandler.getInfoEvent()}])},initTeamDetailEvent:function(){h.controller("teamDetailCtrl",["$scope","$http",function(){$(".left_ul li").eq(5).addClass("left_active").siblings().removeClass("left_active");var a,b=sessionStorage.getItem("cateid"),c=sessionStorage.getItem("eleworker_num"),d=sessionStorage.getItem("woodworker_num"),e=sessionStorage.getItem("brickworker_num"),f=sessionStorage.getItem("paintworker_num"),g=sessionStorage.getItem("mixworker_num");switch(b){case"1":a=g;break;case"2":a=c;break;case"3":a=e;break;case"4":a=d;break;case"5":a=f}$.ajax({type:"get",url:m,async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId")),cate_id:b,page:1,limit:6},success:function(c){if(null!=c&&"000"==c.code){var d='<div class="team_detail_content clearfix">';$.each(c.data,function(a,b){d+='<div class="worker_box sprite_team" data-id="'+b.userid+'" data-action="edit"><a href="#/master/teamDetail_list">',d+='<div class="head_picture"><img src="'+b.portrait_img+'"></div>',d+='<div class="worker_content"><h3><span class="name">'+b.name+"</span>",d+='<span class="age">'+b.age+"岁</span></h3>",d+='<ul class="worker_information"><li>',d+='<span class="span_left">籍贯</span><span class="span_right">'+b.birthplace+"</span></li>",d+='<li><span class="span_left">从业时间</span><span class="span_right">'+b.worktime+"</span></li>",d+='<li><span class="span_left">手机号</span><span class="span_right">'+b.phone+"</span></li>",d+='<li><span class="span_left">身份证号</span><span class="span_right">'+b.idcard+"</span></li>",d+='<li><span class="span_left">开户银行</span><span class="span_right">'+b.bankname+"</span></li>",d+='<li><span class="span_left">银行卡号</span><span class="span_right">'+b.bankcard+"</span></li>",d+="</ul></div></a></div>"}),d+='<div class="worker_box sprite_team worker_add" data-action="add"><a href="#/master/teamDetail_edit"></a></div></div>',$(".team_detail_wrap .page_number").before(d),$(".team_detail_content .worker_box").on("click",function(){var a=$(this).attr("data-id"),b=$(this).attr("data-action");sessionStorage.setItem("userid",a),sessionStorage.setItem("action",b)}),pageHandler.pageContentEvent(a,b)}else layer.msg(c.msg)},error:function(){}})}])},initTeamInfoEvent:function(){h.controller("teamDetail_listCtrl",["$scope","$http",function(){var a=sessionStorage.getItem("cateid"),b=sessionStorage.getItem("userid");$(".left_ul li").eq(5).addClass("left_active").siblings().removeClass("left_active"),$.ajax({type:"get",url:n,async:!0,dataType:"jsonp",data:{cate_id:a,worker_id:b},success:function(a){if(null!=a&&"000"==a.code){$(".staff_bg img").attr("src",""+a.data.portrait_img),$(".staff_top_info .wname .span_val").html(a.data.name),$(".staff_top_info .wage .span_val").html(a.data.age),$(".staff_top_info .wplace .span_val").html(a.data.birthplace),$(".staff_top_info .wtime .span_val").html(a.data.worktime),$(".staff_top_info .wphone .span_val").html(a.data.phone),$(".staff_top_info .wid_number .span_val").html(a.data.idcard),$(".staff_top_info .wbank_name .span_val").html(a.data.bankname),$(".staff_top_info .wbank_account .span_val").html(a.data.bankcard);var b="<ul>";$.each(a.data.pricelist,function(a,c){$.each(c.service,function(a,c){b+='<li><span class="name">'+c.servicename+"</span>",b+='<span class="unit">'+c.unit+"</span>",b+='<span class="num">'+c.cost+"</span></li>"})}),b+="</ul>",$(".staff_bottom_content").append(b)}else layer.msg(a.msg)},error:function(){}})}])},initTeamEditEvent:function(){h.controller("teamDetail_editCtrl",["$scope","$http",function(){$(".left_ul li").eq(5).addClass("left_active").siblings().removeClass("left_active"),loadDetail.showInformation();var a=sessionStorage.getItem("action");"edit"==a?getInformation.workDetail():($(".staff_picture .add_picture").find("input").change(function(){var a=$(this);a.parent().parent().attr("data-flag","0");var b=a.get(0).files[0],c=new FileReader;return/image\/\w+/.test(b.type)?(c.onload=function(b){a.parent().parent().attr("data-flag","1"),a.parent().parent().addClass("clear"),a.parent().siblings(".close").show(),a.parent().parent().css({background:'url("'+b.target.result+'") no-repeat',backgroundSize:"100% 100%"}),$(".close").on("click",function(){$(this).parent().removeClass("clear"),$(this).parent().css("background",""),$(this).hide()})},void c.readAsDataURL(b)):(a.parent().parent().css("background",""),a.parent().parent().removeClass("clear"),layer.alert("请确保文件为图像类型"),a.val(""),!1)}),$(".staff_confirm").on("click",function(){workerAction.addWorker()}))}])},initMShopEvent:function(){h.controller("mShopCtrl",["$scope","$http",function(){$(".Jforeman").html("店铺资料"),$(".left_ul li").eq(2).addClass("left_active").siblings().removeClass("left_active"),getShopInfoHandler.shopInfo()}])},initWithdrawEvent:function(){getWithdrawInfoHandler.getInfoEvent()},initBankEvent:function(){getBankInfoHandler.getInfoEvent(),getBankInfoHandler.getNameEvent(),getBankInfoHandler.getLogoEvent(),getBankInfoHandler.sendCaptcha()},initBillEvent:function(){h.controller("billCtrl",["$scope","$http",function(){$(".Jforeman").html("我的钱包"),$(".left_ul li").eq(8).addClass("left_active").siblings().removeClass("left_active"),getWalletData.getMoney(),getNearByMonth.fiveMonth(),getBillInfoHandler.getInfoEvent()}])},initMOrderEvent:function(){h.controller("mOrderCtrl",["$scope","$http",function(){$(".Jforeman").html("我的订单"),$(".left_ul li").eq(3).addClass("left_active").siblings().removeClass("left_active"),orderList.getInfoEvent(),orderFilter.getEvent()}])},initOrderProcessEvent:function(){getOrderProcessHandler.getInfoEvent(),getOrderBudgetHandler.getInfoEvent()},initMaterialEvent:function(){h.controller("materialCtrl",["$scope","$http",function(){var a,b,c,d,e,f,g;$("#menuNavOuter").remove();var h=sessionStorage.getItem("orderId");$.ajax({type:"get",url:ca,async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(i){null!=i&&"000"==i.code?($.each(i.data.order_list,function(i,j){j.order_id==h&&(a=j.order_time,b=j.user_realname,c=j.user_phone,d=j.order_address,e=j.room+"室"+j.parlour+"厅"+j.toilet+"卫"+j.balcony+"阳台",f=j.area,g=j.user_portrait)}),$(".owner_content .owner_picture img").attr("src",g),$(".owner_summary h3").html(b),$(".owner_summary p span").html(c),$(".owner_left .area h3 span").html(f),$(".owner_left .order p").html(h),$(".owner_middle .type p").html(e),$(".owner_middle .time p").html(a),$(".owner_right .address p").html(d)):layer.msg(i.msg)},error:function(){}}),MaterialList.getList()}])},initMsgInfo:function(){h.controller("msginfoCtrl",["$scope","$http",function(){$(".Jforeman").html("消息中心"),$(".left_ul li").eq(7).addClass("left_active").siblings().removeClass("left_active"),initInfo.info()}])}};startMoveHandler={startMoveEvent:function(a,b,c,d){clearInterval(a.timer),a.timer=setInterval(function(){c+=(b-a.offsetLeft)/10,c*=.7,d+=c,Math.abs(c)<1&&Math.abs(d-b)<1?(clearInterval(a.timer),a.style.left=b+"px"):a.style.left=d+"px"},30)}},arrowClick={getEvent:function(){var a=$(".order_title div").eq(6),b=($(".order_content .order_box"),$(".order_title div").eq(6).find("ul"));$(a).click(function(){$(b).slideDown(500)},function(){$(a).hasClass("item_hover_180")?$(a).removeClass("item_hover_180"):$(a).addClass("item_hover_180"),$(b).slideToggle(500)})}},orderFilter={getEvent:function(){var a=$(".order_title div").eq(6).find("ul li"),b=0;$(a).click(function(){"待确认"==$(this).html()?b=1:"待上门量房"==$(this).html()?b=3:"待用户预支付"==$(this).html()?b=4:"订单进行中"==$(this).html()?b=5:"已完成"==$(this).html()&&(b=6),console.log(b),$.ajax({url:U,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId")),order_status:b,page:1,limit:3},success:function(a){if(a&&"000"==a.code){var c="";f=a.data.order_count,$.each(a.data.order_list,function(b,d){"1"==a.data.order_list[b].order_status?a.data.order_list[b].order_status="待确认":"2"==a.data.order_list[b].order_status?a.data.order_list[b].order_status="待预约":"3"==a.data.order_list[b].order_status?a.data.order_list[b].order_status="待上门量房":"5"==a.data.order_list[b].order_status?a.data.order_list[b].order_status="订单进行中":"6"==a.data.order_list[b].order_status&&(a.data.order_list[b].order_status="已完成"),c+=spliceOrderContent.spliceStrEvent(d),$(".order_wrap").html(c)}),OrderPageHandler.pageContentEvent(f,U,{shop_id:$.base64.decode($.cookie("userShopId")),order_status:b,page:1,limit:3})}else layer.msg(a.msg)},error:function(a){layer.alert(a.msg)}})})}},orderList={getInfoEvent:function(){$.ajax({url:R,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId")),page:1,limit:3},success:function(a){if(a&&"000"==a.code){console.log(a.data),e=a.data.order_count,$(".order_wrap").empty();var b="";$.each(a.data.order_list,function(c,d){"1"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待确认":"2"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待预约":"3"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待上门量房":"4"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待用户预支付":"5"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="订单进行中":"6"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="已完成":"7"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="已取消":"8"==a.data.order_list[c].order_status&&(a.data.order_list[c].order_status="工长店铺取消"),b+=spliceOrderContent.spliceStrEvent(d),$(".order_wrap").html(b)}),OrderPageHandler.pageContentEvent(e,R,{shop_id:$.base64.decode($.cookie("userShopId")),page:1,limit:3}),arrowClick.getEvent()}else"205"==a.code&&($("#orderContent").remove(),$(".not_information").show().removeClass("hide"),$(".not_information_text").html("您的订单空空如也~~"))},error:function(a){layer.alert(a.msg)}}),$(document).off("click",".progress_updates").on("click",".progress_updates",function(a){var b=$(a.target).parents(".block").find(".stage span").html();"已取消"==b||"工长店铺取消"==b?layer.msg("您现在的订单状态还不能点击~~"):(sessionStorage.setItem("status",$(a.target).parents(".order_box").attr("status")),sessionStorage.setItem("step",$(a.target).parents(".order_box").attr("step")),sessionStorage.setItem("orderId",$(a.target).parents(".order_box").attr("orderId")),window.open("order.html#/order"))})}},getOrderProcessHandler={getInfoEvent:function(){h.controller("order",["$scope","$http",function(){$("#menuNavOuter").remove(),new YMDselect("year1","month1","day1");var a=sessionStorage.getItem("step"),b=sessionStorage.getItem("status"),c=sessionStorage.getItem("orderId"),d=sessionStorage.getItem("budgetState"),e=sessionStorage.getItem("statementStatus");if(sessionStorage.getItem("houseStyle"),"待确认"==b||"待预约"==b)$(".order_wrap input").attr("disabled","disabled");else if("待上门量房"==b)$(".order_wrap input").attr("disabled","disabled"),$("#order_edit").attr("disabled",!1);else if("待用户预支付"==b)$(".order_wrap input").attr("disabled","disabled"),$("#order_edit").attr("disabled",!1),$("#order_edit").val("查看"+$("#order_edit").val().substr(2,5));else if("订单进行中"==b)switch(a){case"1":$(".order_process input").attr("disabled","disabled"),layer.alert("您需要先选择装修风格哦~~"),$("#confirm_type").click(function(){var a=$("#testSelect").val();$.ajax({url:da,type:"GET",async:!0,dataType:"jsonp",data:{order_id:c,house_style:a},success:function(b){b&&"000"==b.code&&($(".order_process input").attr("disabled",!1),$(".process_style p").html(a),$(this).hide(),$("#testSelect").hide())}})});for(var f=1;18>f;f++)$(".order_edit").eq(f).addClass("determine_process"),$(".order_increase").eq(f).addClass("add_process");submitOrderProgress.getInfoEvent();break;case"2":case"3":case"6":case"7":case"10":case"11":case"14":case"15":$(".order_increase").eq(parseInt(a)-1).attr("disabled",!1);for(var f=0;f<parseInt(a)-1;f++)$(".process_center").eq(f).find("img").attr("src","image/order_success.png"),$(".order_increase").eq(f).hide(),$(".detail_a").eq(f).css("display","block").removeClass("hide"),("0"==d||"0"==e)&&$(".order_edit ").eq(f).addClass("new_edit"),$(".order_edit ").eq(f).val("查看"+$(".order_edit ").eq(f).val().substr(2,5));for(var f=parseInt(a);18>f;f++)$(".order_edit").eq(f).addClass("determine_process"),$(".order_increase").eq(f).addClass("add_process");submitOrderProgress.getInfoEvent();break;case"4":case"8":case"12":case"16":$(".order_edit").eq(parseInt(a)).attr("disabled","disabled"),$(".order_increase").eq(parseInt(a)-1).attr("disabled",!1);for(var f=0;f<parseInt(a);f++)$(".process_center").eq(f).find("img").attr("src","image/order_success.png"),$(".order_increase").eq(f).hide(),$(".detail_a").eq(f).css("display","block").removeClass("hide"),("0"==d||"0"==e)&&$(".order_edit ").eq(f).addClass("new_edit"),$(".order_edit ").eq(f).val("查看"+$(".order_edit ").eq(f).val().substr(2,5));for(var f=parseInt(a)+1;18>f;f++)$(".order_edit").eq(f).addClass("determine_process"),$(".order_increase").eq(f).addClass("add_process");submitOrderProgress.getInfoEvent();break;case"5":case"9":case"13":case"17":for(var f=0;f<parseInt(a);f++)f!=a-1&&$(".process_center").eq(f).find("img").attr("src","image/order_success.png"),$(".order_increase").eq(f).hide(),$(".detail_a").eq(f).css("display","block").removeClass("hide"),("0"==d||"0"==e)&&$(".order_edit ").eq(f).addClass("new_edit"),0!=f&&$(".order_edit ").eq(f-1).val("查看"+$(".order_edit ").eq(f-1).val().substr(2,5));for(var f=parseInt(a);18>f;f++)$(".order_edit").eq(f).addClass("determine_process"),$(".order_increase").eq(f).addClass("add_process");submitOrderProgress.getInfoEvent()}else if("已完成"==b){for(var f=0;17>f;f++)$(".process_center").eq(f).find("img").attr("src","image/order_success.png"),$(".order_increase").eq(f).hide(),$(".detail_a").eq(f).css("display","block").removeClass("hide"),$(".order_edit ").eq(f).addClass("new_edit"),$(".order_edit ").eq(f).val("查看"+$(".order_edit ").eq(f).val().substr(2,5));$(".order_wrap input").attr("disabled",!1)}else $("#order_edit").attr("disabled",!1),$("#order_edit").val("查看"+$("#order_edit").val().substr(2,5));$(".order_edit").click(function(){$(this).hasClass("determine_process")?layer.msg("亲，你需要先完成上一步~~"):$(this).hasClass("new_edit")?(sessionStorage.setItem("num","0"),window.open("editSheet.html#/budget_sheet")):(sessionStorage.setItem("num","1"),window.open("editSheet.html#/budget_sheet"))}),$(".order_increase").click(function(){var b=sessionStorage.getItem("budgetState");if($(this).hasClass("add_process"))layer.msg("亲，你需要先完成上一步~~");else if("1"==b&&"18"==a)$("#pre_add1").attr("disabled","disabled");else if($(this).hasClass("approach")){var c=$(this).parent(".order_process");$(this).addClass("upload"),$(this).siblings(".detail_a").addClass("detail_upload"),$(".add_technology").show().removeClass("hide"),$(".wrap").show().removeClass("hide"),$(".add_technology").css("top",($(window).height()-c.outerHeight())/2+$(document).scrollTop()-100),orderStartWork.upload()}else sessionStorage.setItem("type",$(this).parent(".order_process").find(".process_title").attr("typename")),window.open("material.html#/material/list")}),$("#add_close").click(function(){$(".add_technology").hide(),$(".wrap").hide()}),$(".detail_a ").click(function(){if($(this).hasClass("detail_m"))sessionStorage.setItem("type",$(this).parent(".order_process").find(".process_title").attr("typename")),window.open("material.html#/material/list");else{var a=$(this).parent(".order_process");$(".see_details").show().removeClass("hide"),$(".wrap").show().removeClass("hide"),$(".see_details").css("top",($(window).height()-a.outerHeight())/2+$(document).scrollTop()-100);var b=$(this).parents(".order_process").index();(5==b||9==b||13==b||17==b)&&(b-=1),orderDeatilWork.detail(b)}}),$(".complete").click(function(){$(".see_details").hide(),$(".wrap").hide()}),$.ajax({type:"get",url:ca,async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){null!=a&&"000"==a.code?($.each(a.data.order_list,function(a,b){b.order_id==c&&(time=b.order_time,name=b.user_realname,phone=b.user_phone,address=b.order_address,type=b.room+"室"+b.parlour+"厅"+b.toilet+"卫"+b.balcony+"阳台",area=b.area,$(".owner_picture img").attr("src",b.user_portrait))}),$(".owner_summary h3").html(name),$(".owner_summary p span").html(phone),$(".owner_left .area h3 span").html(area),$(".owner_left .order p").html("1482835234334098"),$(".owner_middle .type p").html(type),$(".owner_middle .time p").html(time),$(".owner_right .address p").html(address)):layer.msg(a.msg)},error:function(){}}),$.ajax({url:aa,type:"GET",async:!0,dataType:"jsonp",data:{order_id:c},success:function(a){console.log(a),a&&"000"==a.code&&(console.log(a.data),sessionStorage.setItem("budgetState",a.data["预算单编辑状态"]),sessionStorage.setItem("statementStatus",a.data["结算单编辑状态"]))},error:function(){}}),$.ajax({url:da,type:"GET",async:!0,dataType:"jsonp",data:{order_id:c},success:function(b){b&&"000"==b.code&&(console.log(b.data),null!=b.data["装修风格"]&&($(".process_style p").html(b.data["装修风格"]),$("#confirm_type").hide(),$("#testSelect").hide(),sessionStorage.setItem("houseStyle",b.data["装修风格"]),1==a&&($("#pre_add1").attr("disabled",!1),$("#order_edit").attr("disabled",!1))))},error:function(){}})}])}},orderStartWork={upload:function(){function a(a){$(a).find("input").change(function(){var a=$(this),b=a.get(0).files[0],c=new FileReader;return/image\/\w+/.test(b.type)?(c.onload=function(b){a.parent().addClass("opacity"),a.parent().parent().css("background-image",'url("'+b.target.result+'")'),a.parent().parent().find(".close").removeClass("hide").show()},void c.readAsDataURL(b)):(a.parent().parent().css("background-image",""),a.parent().removeClass("opacity"),layer.msg("请确保文件为图像类型"),a.val(""),!1)})}a(".add_picture"),$(".close").click(function(){$(this).parent().find("a").removeClass("opacity"),$(this).parent().css("background-image",""),$(this).hide()}),$(document).off("click","#upload").on("click","#upload",function(){var a=new FormData,b=$(".year1 option:selected"),c=$(".month1 option:selected"),d=$(".day1 option:selected"),e=b.val()+"-"+c.val()+"-"+d.val();a.append("order_id",sessionStorage.getItem("orderId")),a.append("content",$(".message_input").val()),a.append("time",e);for(var f=1;3>=f;f++)$("#file"+f).val()&&a.append("myfile",$("#file"+f)[0].files[0]);$.ajax({url:S,type:"POST",data:a,dataType:"jsonp",jsonp:"callback",cache:!1,processData:!1,contentType:!1,success:function(a){"000"===a.code?(layer.msg(a.msg),$(".upload").hide(),$(".add_technology").hide(),$(".detail_upload").removeClass("hide").show(),$.ajax({url:R,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){if(a&&"000"==a.code){var b=sessionStorage.getItem("orderId");$.each(a.data.order_list,function(a,c){b==c.order_id&&sessionStorage.setItem("step",c.order_step)})}}}),location.reload()):(layer.msg(a.msg),$(".add_technology").hide())},error:function(){alert("错误！！")}})})}},orderDeatilWork={detail:function(a){var b=sessionStorage.getItem("orderId");$.ajax({url:T,type:"GET",async:!0,dataType:"jsonp",data:{order_id:b,order_step:a},success:function(a){if(a&&"000"==a.code){var b=a.data.time.substring(0,10),c=b.split("-");console.log(a.data),$(".start_year").html(c[0]),$(".start_month").html(c[1]),$(".start_day").html(c[2]),$(".detail_describe").html(a.data.content),$.each(a.data.imgs,function(a,b){$(".construction_photo").append('<div class="photo fl"> <img src='+b.img_url+"> </div><!--photo-->")})}else layer.msg(a.msg)},error:function(a){layer.alert(a.msg)}})}},getOrderBudgetHandler={getInfoEvent:function(){h.controller("edit_sheetCtrl",["$scope","$http",function(){$("#menuNavOuter").remove();var a=sessionStorage.getItem("orderId"),b=(sessionStorage.getItem("step"),sessionStorage.getItem("num"));sessionStorage.getItem("budgetState"),sessionStorage.getItem("statementStatus"),$(document).on("blur","input[type=number]",function(a){var b=$(a.target).val();parseInt(b)<0?($(a.target).css("borderColor","red"),layer.tips("数字不能为负!",$(a.target),{tips:[2,"red"],tipsMore:!0,time:1e3})):$(a.target).css("borderColor","#D4D4D4")}),$.ajax({url:Y,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(c){c&&"000"==c.code&&$.each(c.data,function(a,b){"杂工"==b.category?$(".handyman_ul").append('<li> <span class="servicename">'+b.servicename+'</span> <span class="unit"><b>'+b.cost+"</b>元/<i>"+b.unit+'</i></span> <input type="number" bid="'+b.id+'"> </li>'):"水电工"==b.category?$(".plumber_ul").append('<li> <span class="servicename">'+b.servicename+'</span> <span class="unit"><b>'+b.cost+"</b>元/<i>"+b.unit+'</i></span> <input type="number" bid="'+b.id+'"> </li>'):"瓦工"==b.category?$(".bricklayer_ul").prepend('<li> <span class="servicename">'+b.servicename+'</span> <span class="unit"><b>'+b.cost+"</b>元/<i>"+b.unit+'</i></span> <input type="number" bid="'+b.id+'"> </li>'):"木工"==b.category?$(".wood_ul").prepend('<li> <span class="servicename">'+b.servicename+'</span> <span class="unit"><b>'+b.cost+"</b>元/<i>"+b.unit+'</i></span> <input type="number" bid="'+b.id+'"> </li>'):"油漆工"==b.category?$(".painter_ul").append('<li> <span class="servicename">'+b.servicename+'</span> <span class="unit"><b>'+b.cost+"</b>元/<i>"+b.unit+'</i></span> <input type="number" bid="'+b.id+'"> </li>'):"工长"==b.category&&$(".foreman_ul").append('<li> <span class="servicename">'+b.servicename+'</span> <span class="unit"><b>'+b.cost+"</b>元/<i>"+b.unit+'</i></span> <input type="number" bid="'+b.id+'"> </li>')});var d=sessionStorage.getItem("step");"18"==d?($(".sheet_right input").attr("disabled","disabled"),$(".after_submit").attr("disabled","disabled")):($(".sheet_left input").attr("disabled","disabled"),$(".before_submit").attr("disabled","disabled")),$.ajax({url:Z,type:"GET",async:!0,dataType:"jsonp",data:{order_id:a},success:function(a){if(a&&"000"==a.code){console.log(a.data),$("#before_remark").val(a.data["预算单数据"][0].remark),$("#after_remark").val(a.data["结算单数据"][0].remark);var b=a.data["预算单数据"][0];$.each(b,function(a,b){a.indexOf("service")>=0&&$('.sheet_left input[bid="'+a.substring(7)+'"]').val(b)});var c=a.data["结算单数据"][0];$.each(c,function(a,b){a.indexOf("service")>=0&&$('.sheet_right input[bid="'+a.substring(7)+'"]').val(b)})}},error:function(){}}),"0"==b&&$(".construction_sheet input").attr("disabled","disabled")},error:function(){}});var c={};$(document).on("click",".before_submit",function(){var b=$('.sheet_left input[type="number"]');$.each(b,function(a,b){c[parseInt($(b).attr("bid")-1)]=$(b).val()}),$.ajax({url:X,type:"GET",async:!0,dataType:"jsonp",data:{order_id:a},success:function(){$.ajax({url:W,type:"GET",async:!0,dataType:"jsonp",data:{order_id:a,list_data_json:JSON.stringify(c),remark:$("#before_remark").val()},success:function(a){a&&"000"==a.code&&(window.location.href="order.html#/order/home")},error:function(){}})},error:function(){}})}),$(document).on("click",".after_submit",function(){var b={},c=$('.sheet_right input[type="number"]');$.each(c,function(a,c){b[parseInt($(c).attr("bid")-1)]=$(c).val()}),$.ajax({url:_,type:"GET",async:!0,dataType:"jsonp",data:{order_id:a,list_data_json:JSON.stringify(b),remark:$("#after_remark").val()},success:function(a){layer.msg(a.msg),a&&"000"==a.code&&(window.location.href="order.html#/order/home")},error:function(){}})})}])}},submitOrderProgress={getInfoEvent:function(){var a=sessionStorage.getItem("orderId");$(document).on("click",".order_submit",function(){$.ajax({url:V,type:"GET",async:!0,dataType:"jsonp",data:{order_id:a},success:function(a){layer.msg(a&&"000"==a.code?a.msg:a.msg)},error:function(a){layer.alert(a.msg)}})})}},MaterialList={getList:function(){h.controller("listCtrl",["$scope","$http",function(){var a=sessionStorage.getItem("orderId"),b=sessionStorage.getItem("type");"木工"==b?b="wood":"水电"==b?b="ele":"瓦工"==b?b="brick":"油漆"==b&&(b="paint"),$.ajax({type:"get",url:ba,async:!0,dataType:"jsonp",data:{order_id:a},success:function(a){if(null!=a&&"000"==a.code){var c="<ul>";switch(b){case"ele":var d=a.data.ele;$(".title_picture em").css("background-position","-286px -261px"),$(".type_cname").html("水电工"),$(".type_ename").html("PLUMBER");break;case"brick":var d=a.data.brick;$(".title_picture em").css("background-position","-30px -261px"),$(".type_cname").html("瓦工"),$(".type_ename").html("BRICKLAYER");break;case"wood":var d=a.data.wood;$(".title_picture em").css("background-position","-418px -261px"),$(".type_cname").html("木工"),$(".type_ename").html("WOODWORKING");break;case"paint":var d=a.data.paint;$(".title_picture em").css("background-position","-155px -261px"),$(".type_cname").html("油漆工"),$(".type_ename").html("PAINTER")}$.each(d,function(a,b){c+='<li><div class="picture">',c+='<img src="'+b.img+'"></div>',c+='<div class="name">'+b.name+"</div>",c+='<div class="li_right clearfix" id="li_right"><div class="format">',b.spec.length>1?($.each(b.spec,function(a,b){c+="<span>"+b.spec_name+"</span>"}),c+='</div><div class="unit">',$.each(b.spec,function(){c+="<span>"+b.unit+"</span>"}),c+='</div><div class="number">',$.each(b.spec,function(a,b){c+='<div class="control_number"><span class="minus"></span>',c+='<input type="text" value="'+b.num+'" data-id="'+b.id+'"><span class="plus"></span></div>'})):(c+='<span class="none"></span>',c+='</div><div class="unit">',c+='<span class="none">'+b.unit+"</span>",c+='</div><div class="number">',
c+='<div class="control_number none"><span class="minus"></span>',c+='<input type="text" value="'+b.spec.num+'" data-id="'+b.spec.id+'"><span class="plus"></span></div>'),c+="</div></div></li>"}),c+="</ul>",$(".sure_send").before(c),numberControl.plusMinus(),sureSend.toUser()}else layer.msg(a.msg)},error:function(){}})}])}},numberControl={plusMinus:function(){$(".control_number .minus").on("click",function(){var a=$(this).siblings("input");if(a.val()<="0")layer.msg("请输入合理的数量！");else{var b=Math.ceil(a.val());b--,a.val(b)}}),$(".control_number .plus").on("click",function(){var a=$(this).siblings("input"),b=Math.ceil(a.val());b++,a.val(b)})}},sureSend={toUser:function(){$(".sure_send").on("click",function(){for(var a=!0,b=$(".material_content").find("ul input"),c={},d=[],e=[],f=0,g=0;g<b.length;g++)d[g]=b.eq(g).attr("data-id"),b.eq(g).val()!=Math.ceil(b.eq(g).val())?a=!1:(e[g]=b.eq(g).val(),f++),c[d[g]]=e[g];var h=JSON.stringify(c);if(a){var i,j=sessionStorage.getItem("orderId"),k=sessionStorage.getItem("type");"木工"==k?i=3:"水电"==k?i=1:"瓦工"==k?i=4:"油漆"==k&&(i=5),$.ajax({type:"get",url:ea,async:!0,dataType:"jsonp",data:{order_id:j,material_type:i,material_arr:h},beforeSend:function(){$(".sure_send").attr("disabled",!0)},success:function(a){null!=a&&"000"==a.code?(layer.msg(a.msg),window.location.href="order.html#/order/home"):layer.msg(a.msg)},complete:function(){$(".sure_send").attr("disabled",!1)},error:function(a){console.log(a)}})}})}},getHomeInfoHandler={getInfoEvent:function(){$.ajax({url:v,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){a&&"000"==a.code&&($(".head").html('<img src="'+a.data.foremanimg+'">'),$("#shop_name").html(a.data.shop_name),$("#real_name").attr("src",""+a.data.authentication[0]),$("#safe_name").attr("src",""+a.data.authentication[1]),$("#team_person").html(a.data.shop_workernum),$("#shop_scan").html(a.data.shop_scan),$("#projectquality").html(a.data.shop_score.projectquality),$("#serviceattitude").html(a.data.shop_score.serviceattitude),$("#overallmerit").html(a.data.shop_score.overallmerit),$("#collectnum").html(a.data.collectnum))},error:function(){}}),$.ajax({url:R,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){if(a&&"000"==a.code){var b=[],c=[];$.each(a.data.order_list,function(a,d){"5"==d.order_status?b.push(d):"6"==d.order_status&&c.push(d)}),$("#completed").html(c.length),$("#order_progress").html(b.length)}},error:function(a){layer.alert(a.msg)}}),$(".enter_store").click(function(){window.location.href="view_shop.html#/shopdetails?pos="+$.base64.decode($.cookie("userShopId"))})},getSafeEvent:function(){$.ajax({dataType:"JSONP",url:l,type:"GET",async:!0,data:{user_id:oa},success:function(a){a&&"000"==a.code&&(parseInt(a.data.score)>0&&parseInt(a.data.score)<=3.3?($("#active_level").css("width","47px"),$(".safe_name span").eq(0).addClass("active_name")):parseInt(a.data.score)>3.3&&parseInt(a.data.score)<=6.7?($("#active_level").css("width","94px"),$(".safe_name span").eq(1).addClass("active_name")):($("#active_level").css("width","141px"),$(".safe_name span").eq(2).addClass("active_name")))},error:function(){}})},getEmailEvent:function(){$.ajax({url:j,type:"GET",async:!0,dataType:"jsonp",data:{foreman_id:oa},success:function(b){null!=b&&"000"==b.code&&(a=b.data.foremaninfo_email,null!=a&&$("#email_p").html("<span>"+a+'</span><a href="#/master/setting/email/email_1">修改绑定</a>'))},error:function(){}})}},getMasterInfoHandler={getInfoEvent:function(){var b=$(".personal_area_list .area_edit"),c=[],d='<div class="fl reduce"><input class="input_all" type="text" title=""> <a class="experience" href="javascript:;">-</a></div> ',e='<div class="fl reduce"><input class="personal_user_community" type="text" title=""> <a class="experience" href="javascript:;">-</a></div> ';h.controller("personal",["$scope","$http",function(b,c){c({method:"JSONP",url:j,params:{foreman_id:oa}}).success(function(b){if("000"===b.code){console.log(b);var c=b.data.foremaninfo_phone.substr(0,3)+"****"+b.data.foremaninfo_phone.substr(7,11);if($(".personal_tel").html(c),$(".personal_user_age").val(b.data.foremaninfo_age),$(".personal_user_nickname").val(b.data.foremaninfo_nickname),$(".personal_area_detail").val(b.data.loc_address),a=b.data.foremaninfo_email,null!=a){var d=a.length,e=a.substr(0,3)+"****"+a.substr(d-3,d);$("#email_p").html("<span>"+e+'</span><a href="#/master/setting/email/email_1">修改绑定</a>')}$(".personal_user_name").val($.base64.decode($.cookie("userName"))),1==b.data.foremaninfo_sex?$("#man").attr("checked","checked"):$("#women").attr("checked","checked");for(var f=b.data.experience.length,g=0;f>g;g++)$(".personal_form_area").append('<div class="fl"> <input type="text" title="" class="input_all" value="'+b.data.experience[g]+'"> <a class="experience" href="javascript:;">-</a></div>');$(".input_all").eq(0).addClass("first");for(var h=b.data.servicearea.length,g=0;h>g;g++)$("#personal_circle").before('<a class="personal_area" href="javascript:;">'+b.data.servicearea[g]+"</a>");for(var i=b.data.decoratedareas.length,g=0;i>g;g++)$(".renovation_area").append('<div class="fl"> <input type="text" title="" class="personal_user_community" value="'+b.data.decoratedareas[g]+'"> <a class="experience" href="javascript:;">-</a></div>');2==b.data.isedit&&$(".personal_user_name").attr("disabled",!0),$(".personal_user_community").eq(0).addClass("personal_user_first"),null!=b.data.loc_province&&""!=b.data.loc_province&&$("#loc").distpicker({province:b.data.loc_province}),null!=b.data.loc_city&&""!=b.data.loc_city&&$("#loc").distpicker({city:b.data.loc_city}),null!=b.data.loc_district&&""!=b.data.loc_district&&$("#loc").distpicker({district:b.data.loc_district}),null!=b.data.home_province&&""!=b.data.home_province&&$("#home").distpicker({province:b.data.home_province}),null!=b.data.home_city&&""!=b.data.home_city&&$("#home").distpicker({city:b.data.home_city}),null!=b.data.home_district&&""!=b.data.home_district&&$("#home").distpicker({district:b.data.home_district})}else layer.alert(b.msg)}).error(function(){})}]),$("#personal_circle").click(function(){b.removeClass("display");for(var a=0;a<$(".personal_area_list .personal_area").length;a++)c[a]=$(".personal_area_list .personal_area").eq(a).html();for(var a=0;a<$(".personal_area_list .area_edit span").length;a++)$.inArray($(".personal_area_list .area_edit span").eq(a).html(),c)>=0&&$(".personal_area_list .area_edit span").eq(a).addClass("current");b.find("span").unbind("click").click(function(){if($(this).hasClass("current")){$(this).removeClass("current");for(var a=0;a<$(".personal_area_list .personal_area").length;a++)$(this).html()==$(".personal_area_list .personal_area").eq(a).html()&&$(".personal_area_list .personal_area").eq(a).remove()}else $(this).addClass("current"),$("#personal_circle").before('<a class="personal_area" href="javascript:;">'+$(this).html()+"</a>")}),b.find(".area_sure").unbind("click").click(function(){b.addClass("display"),c=[]})}),$("#experience_circle").click(function(){$(".personal_form_area").append(d),$(".input_all").eq(0).addClass("first")}),$(document).on("click",".experience",function(){$(this).parent().remove()}),$("#area_circle").click(function(){$(".renovation_area").append(e),$(".personal_user_community").eq(0).addClass("personal_user_first")}),$("#personal_submit").click(function(){for(var a=[],b=[],c=[],d=0;d<$(".input_all").length;d++)a.push($(".input_all").eq(d).val());for(var d=0;d<$(".personal_user_community").length;d++)b.push($(".personal_user_community").eq(d).val());for(var d=0;d<$(".personal_area").length;d++)c.push($(".personal_area").eq(d).html());$.ajax({url:L,type:"GET",async:!0,dataType:"jsonp",data:{foreman_id:oa,name:$(".personal_user_name").val(),nickname:$(".personal_user_nickname").val(),age:$(".personal_user_age").val(),experience:a,decoratedareas:b,servicearea:c,loc_address:$(".personal_area_detail").val(),loc_province:$("#province1").val(),loc_city:$("#city1").val(),loc_district:$("#district1").val(),home_province:$("#province2").val(),home_city:$("#city2").val(),home_district:$("#district2").val(),sex:$("input[name='sex']:checked").val()},success:function(a){null!=a&&"000"==a.code&&layer.msg(a.msg)},error:function(){}})})}},getWalletData={getMoney:function(){$.ajax({type:"get",url:t,async:!0,dataType:"jsonp",data:{user_id:oa},success:function(a){null!=a&&"000"==a.code?($(".wallet_content_top li .withdraw span").html(a.data.available_total),sessionStorage.setItem("availableTotal",a.data.available_total),$(".wallet_content_top li .total span").html(a.data.total)):layer.alert(a.msg)},error:function(){}})}},getNearByMonth={fiveMonth:function(){var a,b=new Date,c=[],d=[],e=[];for(a=0;5>a;a++)c[a]=""+b.getFullYear();for(d[0]=b.getMonth()+1,a=1;5>a;a++)if(d[a]=d[a-1]-1,d[a]<=0){d[a]+=12,c[a]--;for(var f=a+1;5>f;f++)c[f]=c[f-1]}for(a=0;5>a;a++)d[a]<10&&(d[a]="0"+d[a]),e[a]=c[a]+" - "+d[a],$(".bottom_title_left a").eq(a).html(e[a])}},BillDelete={deleteRecord:function(){$(".dd_opera").on("click",function(){var a=$(this).parent().attr("data-id");$.ajax({type:"get",url:u,async:!0,dataType:"jsonp",data:{id:a},success:function(a){a&&"000"==a.code?getBillInfoHandler.getInfoEvent():layer.alert(a.msg)},error:function(){}})})}},getBillInfoHandler={getInfoEvent:function(){var a,b;$(".bottom_title_left a").eq(0).addClass("active"),a=$(".bottom_title_left a").eq(0).html().substring(0,4)+$(".bottom_title_left a").eq(0).html().substring(7,9),$(".wallet_month").html($(".bottom_title_left a").eq(0).html()),$(".bottom_title_left a").on("click",function(){$(this).addClass("active").siblings().removeClass("active"),$(".wallet_month").html($(this).html()),b=$(this).html().substring(0,4)+$(this).html().substring(7,9),$.ajax({type:"get",url:s,async:!0,dataType:"jsonp",data:{user_id:oa,month:b,page:1,limit:4},success:function(a){if(null!=a&&"000"==a.code){var c="",d=a.data[0].total;$.each(a.data,function(a,b){c+=spliceBillContent.spliceStrEvent(b)}),$(".wallet_dl").nextAll().remove(),$(".wallet_bottom_content").append(c),BillDelete.deleteRecord(),BillPageHandler.pageContentEvent(d,b),$(".not_information").hide(),$(".not_information_text").html(),$(".page_number").css("opacity","1")}else $(".wallet_dl").nextAll().remove(),$(".page_number").css("opacity","0"),$(".not_information").show().removeClass("hide"),$(".not_information_text").html("您还没有交易记录哦~~")},error:function(){}})}),$.ajax({type:"get",url:s,async:!0,dataType:"jsonp",data:{user_id:oa,month:a,page:1,limit:4},success:function(b){if(null!=b&&"000"==b.code){console.log(b);var c="",d=b.data[0].total;$.each(b.data,function(a,b){c+=spliceBillContent.spliceStrEvent(b)}),$(".wallet_dl").nextAll().remove(),$(".wallet_bottom_content").append(c),BillDelete.deleteRecord(),BillPageHandler.pageContentEvent(d,a)}else $(".wallet_dl").nextAll().remove(),$(".page_number").css("opacity","0"),$(".not_information").show().removeClass("hide"),$(".not_information_text").html("您还没有交易记录哦~~")},error:function(){}})}},BillPageHandler={pageContentEvent:function(a,b){$(".page_div5").empty().paging({total:Math.ceil(a/4),animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:s,ajaxData:{user_id:oa,month:b,page:1,limit:4},dataOperate:function(a){$(".wallet_dl").nextAll().remove();var b="";$.each(a.data,function(a,c){b+=spliceBillContent.spliceStrEvent(c)}),$(".wallet_dl").nextAll().remove(),$(".wallet_bottom_content").append(b),BillDelete.deleteRecord(),$(".not_information").hide(),$(".not_information_text").html(),$(".page_number").css("opacity","1")}})}},spliceBillContent={spliceStrEvent:function(a){var b='<div class="wallet_dd" data-id="'+a.id+'">';return b+='<span class="wallet_time">'+a.time+"</span>",b+='<span class="wallet_account">'+a.content+"</span>",b+='<span class="wallet_coin">'+a.money+"</span>",b+='<span class="wallet_cash">支付成功</span>',b+='<a href="javascript:;" class="dd_opera">',b+='<em class="sprite_team"></em>',b+="</a></div>"}},getWithdrawInfoHandler={getInfoEvent:function(){h.controller("withdraw",["$scope","$http",function(a,b){$("#headerWrapper").remove();var c=sessionStorage.getItem("availableTotal");$(".current_balance b").html(c),b({method:"JSONP",url:F,params:{user_id:oa}}).success(function(b){if("000"===b.code){console.log(b);for(var c=0;c<b.data.length;c++){var d=b.data[c].bankcardno;b.data[c].bankcardnoDim=d.substr(d.length-4)}a.wbanks=b.data}else $("#choose_bank").append('<div class="not_bank fl"> <span>您还没有绑定银行卡哦~~ 点击去</span><a href="bank.html#/bank/home"> 绑定 </a> </div><!--not_bank-->')}).error(function(){}),$("#cash_confirm").click(function(){var b=$('input:radio[name="money"]:checked').val();if(null==b)return layer.alert("请至少选择一个银行卡！"),!1;if(""==$("#money").val())layer.alert("提现金额不能为空！");else if($("#money").val()<=0)layer.alert("提现金额不能小于等于0！");else{var c;$.each(a.wbanks,function(a,b){$(".bank :radio").eq(a).data("no",b.bankcardno),b.bankcardno==$(".bank :radio:checked").data("no")&&(c=b)}),$.ajax({url:r,type:"GET",async:!0,dataType:"jsonp",data:{user_id:oa,bankcardno:c.bankcardno,bankname:c.bankname,cardtype:c.cardtype,money:$("#money").val()},success:function(a){"000"==a.code?($(".withdraw_complete").show().removeClass("hide"),$(".withdraw_contentWrap").hide()):layer.msg(a.msg)},error:function(a){layer.alert(a.msg)}})}})}])}},getBankInfoHandler={getInfoEvent:function(){h.controller("bank",["$scope","$http",function(a,b){$("#headerWrapper").remove(),b({method:"JSONP",url:F,params:{user_id:oa}}).success(function(b){if("000"===b.code){console.log(b);for(var c=0;c<b.data.length;c++){var d=b.data[c].bankcardno;b.data[c].bankcardno=d.substr(d.length-4)}a.banks=b.data}else layer.alert(b.msg)}).error(function(){})}]),h.controller("process4",["$scope","$http",function(){$("#headerWrapper").remove()}])},getNameEvent:function(){h.controller("process1",["$scope","$http",function(){$("#headerWrapper").remove(),$.ajax({url:C,type:"GET",async:!0,dataType:"jsonp",data:{user_id:oa},success:function(a){a&&"000"==a.code&&(b=a.data.realname,c=a.data.idcardno,$("#process1_next").click(function(){""==$("#card_name").val()?layer.alert("持卡人姓名不能为空"):$("#card_name").val()!=b?layer.alert("持卡人姓名与真实姓名不相符"):""==$("#card_no").val()?layer.alert("卡号不能为空"):qa.test($("#card_no").val())?(window.location.href="#bank/add_process2",sessionStorage.setItem("bankcardno",$("#card_no").val()),sessionStorage.setItem("realname",a.data.realname),sessionStorage.setItem("idcardno",a.data.idcardno)):layer.alert("银行卡格式不正确")}))},error:function(a){layer.alert(a.msg)}})}])},getLogoEvent:function(){h.controller("process2",["$scope","$http",function(){var a=sessionStorage.getItem("bankcardno");$("#headerWrapper").remove(),$.ajax({url:D,type:"GET",async:!0,dataType:"jsonp",data:{user_id:oa,realname:b,idcardno:c,bankcardno:a},success:function(a){console.log(a),a&&"000"==a.code&&($("#card_type").attr("placeholder",a.data.bankname),$("#process2_next").click(function(){""==$("#reserved_phone").val()?layer.alert("电话不能为空"):pa.test($("#reserved_phone").val())?(window.location.href="#bank/add_process3",sessionStorage.setItem("phone",$("#reserved_phone").val()),sessionStorage.setItem("bankname",a.data.bankname),sessionStorage.setItem("cardtype",a.data.cardtype),sessionStorage.setItem("banklogo",a.data.banklogo)):layer.alert("手机号码格式不正确")}))},error:function(a){layer.alert(a.msg)}})}])},sendCaptcha:function(){h.controller("process3",["$scope","$http",function(){$("#headerWrapper").remove();var a=sessionStorage.getItem("phone"),b=sessionStorage.getItem("bankcardno"),c=sessionStorage.getItem("bankname"),d=sessionStorage.getItem("cardtype"),e=sessionStorage.getItem("banklogo"),f=sessionStorage.getItem("realname"),g=sessionStorage.getItem("idcardno"),h=$("#verification_code"),i=a.substr(0,3)+"****"+a.substr(7,11);$("#phone_number").html(i),h.click(function(){var b=60;$.ajax({url:G,type:"GET",async:!0,dataType:"jsonp",data:{phone:a},success:function(a){"000"==a.code?(h.addClass("zc_btnClick").attr("disabled",!0),h.html(b+"秒后重新获取"),InterValObj=window.setInterval(function(){1==b?(window.clearInterval(InterValObj),h.removeClass("zc_btnClick").removeAttr("disabled"),h.html("获取验证码")):(b--,h.html(b+"秒后重新获取"))},1e3)):layer.alert(a.msg)},error:function(){}})}),$("#process3_next").click(function(){""==$("#code_input").val()?layer.alert("验证码不能为空"):$.ajax({url:E,type:"GET",async:!0,dataType:"jsonp",data:{user_id:oa,realname:f,idcardno:g,bankcardno:b,bankname:c,cardtype:d,phone:a,captcha:$("#code_input").val(),banklogo:e},success:function(a){console.log(a),"000"==a.code&&(window.location.href="#bank/add_process4")},error:function(a){layer.alert(a.msg)}})})}])}},getTeamInfoHandler={getInfoEvent:function(){var a=$(".team_bg_wrap");$.ajax({url:m,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId"))},success:function(b){null!=b&&"000"==b.code&&(sessionStorage.setItem("eleworker_num",b.data.eleworker.length),sessionStorage.setItem("woodworker_num",b.data.woodworker.length),sessionStorage.setItem("brickworker_num",b.data.brickworker.length),sessionStorage.setItem("paintworker_num",b.data.paintworker.length),sessionStorage.setItem("mixworker_num",b.data.mixworker.length),$("#eleworker").html(b.data.eleworker.length),$("#woodworker").html(b.data.woodworker.length),$("#brickworker").html(b.data.brickworker.length),$("#paintworker").html(b.data.paintworker.length),$("#mixworker").html(b.data.mixworker.length),$(".team_content .team_bg_wrap").on("click",function(){var a=$(this).children("a").attr("data-id");sessionStorage.setItem("cateid",a)}),a.eq(0).css("background","url("+b.data.eleworker[0].portrait_img+")"),a.eq(1).css("background","url("+b.data.woodworker[0].portrait_img+")"),a.eq(2).css("background","url("+b.data.brickworker[0].portrait_img+")"),a.eq(3).css("background","url("+b.data.paintworker[0].portrait_img+")"),a.eq(4).css("background","url("+b.data.mixworker[0].portrait_img+")"))},error:function(){}})}},workerAction={editWorker:function(){var a=[],b=sessionStorage.getItem("cateid"),c=sessionStorage.getItem("userid"),d=!0,e=$(".staff_name .name").val(),f=$(".staff_name .sex option:selected").val(),g=$(".staff_name .age").val(),h=$(".staff_home .place").val(),i=$(".staff_date input").val(),j=$(".staff_phone .idcard").val(),k=$(".staff_phone .bankcard").val(),l=$(".staff_phone .phone").val(),m=$(".staff_phone .bankname").val();""==e||null==e?(layer.alert("姓名不能为空"),d=!1):""==g||null==g?(layer.alert("年龄不能为空"),d=!1):""==i||null==i?(layer.alert("从业时间不能为空"),d=!1):""==l||null==l?(layer.alert("手机号不能为空"),d=!1):""==j||null==j?(layer.alert("身份证号不能为空"),d=!1):""==m||null==m?(layer.alert("开户银行不能为空"),d=!1):(""==k||null==k)&&(layer.alert("银行卡号不能为空"),d=!1);for(var n=0;n<$(".edit_bottom li input").length;n++)if(""==$(".edit_bottom li input").eq(n).val()||null==$(".edit_bottom li input").eq(n).val()){layer.alert("价格明细表有项未填"),d=!1;break}if(d)switch(b){case"1":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+1]=$(".edit_bottom li input").eq(n).val();$.ajax({type:"get",url:o,async:!0,dataType:"jsonp",data:{cate_id:b,worker_id:c,name:e,sex:f,age:g,birthplace:h,worktime:i,idcard:j,bankcard:k,phone:l,bankname:m,service1:a[1],service2:a[2],service3:a[3],service4:a[4],service5:a[5],service6:a[6],service7:a[7],service8:a[8],service9:a[9],service10:a[10],service11:a[11],service12:a[12],service13:a[13],service14:a[14],service15:a[15],service16:a[16]},success:function(a){null!=a&&"000"==a.code?(layer.msg(a.msg),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)}});break;case"2":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+17]=$(".edit_bottom li input").eq(n).val();$.ajax({type:"get",url:o,async:!0,dataType:"jsonp",data:{cate_id:b,worker_id:c,name:e,sex:f,age:g,birthplace:h,worktime:i,idcard:j,bankcard:k,phone:l,bankname:m,service17:a[17],service18:a[18]},success:function(a){null!=a&&"000"==a.code?(layer.msg(a.msg),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)}});break;case"3":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+19]=$(".edit_bottom li input").eq(n).val();$.ajax({type:"get",url:o,async:!0,dataType:"jsonp",data:{cate_id:b,worker_id:c,name:e,sex:f,age:g,birthplace:h,worktime:i,idcard:j,bankcard:k,phone:l,bankname:m,service19:a[19],service20:a[20],service21:a[21],service22:a[22],service23:a[23],service23:a[23],service24:a[24],service25:a[25],service26:a[26],service27:a[27],service28:a[28],service29:a[29],service30:a[30],service31:a[31],service32:a[32],service33:a[33],service34:a[34],service35:a[35],service36:a[36],service37:a[37],service38:a[38],service39:a[39],service40:a[40],service41:a[41]},success:function(a){null!=a&&"000"==a.code?(layer.msg(a.msg),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)}});break;case"4":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+42]=$(".edit_bottom li input").eq(n).val();$.ajax({type:"get",url:o,async:!0,dataType:"jsonp",data:{cate_id:b,worker_id:c,name:e,sex:f,age:g,birthplace:h,worktime:i,idcard:j,bankcard:k,phone:l,bankname:m,service42:a[42],service43:a[43],service44:a[44],service45:a[45],service46:a[46],service47:a[47],service48:a[48],service49:a[49],service50:a[50],service51:a[51],service52:a[52],service53:a[53]},success:function(a){null!=a&&"000"==a.code?(layer.msg(a.msg),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)}});break;case"5":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+54]=$(".edit_bottom li input").eq(n).val();$.ajax({type:"get",url:o,async:!0,dataType:"jsonp",data:{cate_id:b,worker_id:c,name:e,sex:f,age:g,birthplace:h,worktime:i,idcard:j,bankcard:k,phone:l,bankname:m,service54:a[54],service55:a[55],service56:a[56],service57:a[57],service58:a[58],service59:a[59],service60:a[60],service61:a[61],service62:a[62],service63:a[63]},success:function(a){null!=a&&"000"==a.code?(layer.msg(a.msg),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)}})}},addWorker:function(){var a=[],b=sessionStorage.getItem("cateid"),c=(sessionStorage.getItem("shopid"),!0),d=new FormData,e=$(".staff_name .name").val(),f=$(".staff_name .sex option:selected").val(),g=$(".staff_name .age").val(),h=$(".staff_home .place").val(),i=$(".staff_date input").val(),j=$(".staff_phone .idcard").val(),k=$(".staff_phone .bankcard").val(),l=$(".staff_phone .phone").val(),m=$(".staff_phone .bankname").val();d.append("cate_id",b),d.append("myfile",$("#worker_picture")[0].files[0]),d.append("shop_id",$.base64.decode($.cookie("userShopId"))),d.append("name",e),d.append("sex",f),d.append("age",g),d.append("birthplace",h),d.append("worktime",i),d.append("idcard",j),d.append("bankcard",k),d.append("phone",l),d.append("bankname",m),"0"==$(".staff_picture .add_picture").attr("data-flag")?(layer.msg("未上传头像"),c=!1):""==e||null==e?(layer.msg("姓名不能为空"),c=!1):""==g||null==g?(layer.msg("年龄不能为空"),c=!1):""==i||null==i?(layer.msg("从业时间不能为空"),c=!1):""==l||null==l?(layer.msg("手机号不能为空"),c=!1):""==j||null==j?(layer.msg("身份证号不能为空"),c=!1):""==m||null==m?(layer.msg("开户银行不能为空"),c=!1):(""==k||null==k)&&(layer.msg("银行卡号不能为空"),c=!1);for(var n=0;n<$(".edit_bottom li input").length;n++)if(""==$(".edit_bottom li input").eq(n).val()||null==$(".edit_bottom li input").eq(n).val()){layer.msg("价格明细表有项未填"),c=!1;break}if(c)switch(b){case"1":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+1]=$(".edit_bottom li input").eq(n).val(),d.append("service"+(n+1),a[n+1]);$.ajax({type:"post",url:p,dataType:"text",data:d,cache:!1,processData:!1,contentType:!1,success:function(a){a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a=JSON.parse(a),"000"==a.code?(layer.msg("添加工人成功"),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)},error:function(){layer.alert("未知错误")}});break;case"2":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+17]=$(".edit_bottom li input").eq(n).val(),d.append("service"+(n+17),a[n+17]);$.ajax({type:"post",url:p,dataType:"text",data:d,cache:!1,processData:!1,contentType:!1,success:function(a){a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a=JSON.parse(a),"000"==a.code?(layer.msg("添加工人成功"),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)},error:function(){layer.alert("未知错误")}});break;case"3":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+19]=$(".edit_bottom li input").eq(n).val(),d.append("service"+(n+19),a[n+19]);$.ajax({type:"post",url:p,dataType:"text",data:d,cache:!1,processData:!1,contentType:!1,success:function(a){a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a=JSON.parse(a),"000"==a.code?(layer.msg("添加工人成功"),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)},error:function(){layer.alert("未知错误")}});break;case"4":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+42]=$(".edit_bottom li input").eq(n).val(),d.append("service"+(n+42),a[n+42]);$.ajax({type:"post",url:p,dataType:"text",data:d,cache:!1,processData:!1,contentType:!1,success:function(a){a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a=JSON.parse(a),"000"==a.code?(layer.msg("添加工人成功"),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)},error:function(){layer.alert("未知错误")}});break;case"5":for(var n=0;n<$(".edit_bottom li input").length;n++)a[n+54]=$(".edit_bottom li input").eq(n).val(),d.append("service"+(n+54),a[n+54]);$.ajax({type:"post",url:p,dataType:"text",data:d,cache:!1,processData:!1,contentType:!1,success:function(a){a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a=JSON.parse(a),"000"==a.code?(layer.msg("添加工人成功"),window.location.href="#/master/mteam",location.reload(!0)):layer.alert(a.msg)},error:function(){layer.alert("未知错误")}})}}},getInformation={workDetail:function(){var a=sessionStorage.getItem("cateid"),b=sessionStorage.getItem("userid");$.ajax({type:"get",url:n,async:!0,dataType:"jsonp",data:{cate_id:a,worker_id:b},success:function(a){if(a&&"000"==a.code){var c=[],d=0,e=$(".edit_bottom li").length;$(".staff_picture .add_picture").attr("data-flag","1").addClass("clear").css({background:'url("'+a.data.portrait_img+'") no-repeat',backgroundSize:"100% 100%"}),$(".staff_name .name").val(a.data.name),$(".staff_name .sex option:selected").val(a.data.sex),$(".staff_name .age").val(a.data.age),$(".staff_home .place").val(a.data.birthplace),$(".staff_date input").val(a.data.worktime),$(".staff_phone .idcard").val(a.data.idcard),$(".staff_phone .bankcard").val(a.data.bankcard),$(".staff_phone .phone").val(a.data.phone),$(".staff_phone .bankname").val(a.data.bankname),$.each(a.data.pricelist,function(a,b){$.each(b.service,function(a,b){c[d]=b.cost,d++})});for(var f=0;e>f;f++)$(".edit_bottom li").eq(f).find("input").val(c[f]);$(".staff_picture .add_picture").find("input").change(function(){var a=$(this);a.parent().parent().attr("data-flag","0");var c=a.get(0).files[0],d=new FileReader;return/image\/\w+/.test(c.type)?(d.onload=function(c){a.parent().parent().attr("data-flag","1"),a.parent().parent().addClass("clear"),a.parent().parent().css({background:'url("'+c.target.result+'") no-repeat',backgroundSize:"100% 100%"});var d=new FormData;d.append("myfile",$("#worker_picture")[0].files[0]),d.append("user_id",b),$.ajax({type:"post",url:k,cache:!1,data:d,dataType:"text",processData:!1,contentType:!1,success:function(a){a=a.substring(a.indexOf("(")+1,a.indexOf(")")),a=JSON.parse(a),layer.alert(a.msg)},error:function(){layer.alert("未知错误")}})},void d.readAsDataURL(c)):(a.parent().parent().css("background",""),a.parent().parent().removeClass("clear"),layer.alert("请确保文件为图像类型"),a.val(""),!1)}),$(".staff_confirm").on("click",function(){workerAction.editWorker()})}else layer.alert(a.msg)},error:function(){}})}},loadDetail={showInformation:function(){var a=sessionStorage.getItem("cateid");$.ajax({type:"get",url:q,async:!0,dataType:"jsonp",data:{cate_id:a,shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){var b="<ul>";null!=a&&"000"==a.code&&($.each(a.data,function(a,c){$.each(c.service,function(a,c){b+='<li><span class="name">'+c.servicename+"</span>",b+='<input title="" type="text" value="'+c.cost+'">',b+='<span class="unit">'+c.unit+"</span>"})}),b+="</ul>",$(".edit_bottom").append(b))},error:function(){}})},showTable:function(){var a=sessionStorage.getItem("cateid");$.ajax({type:"get",url:q,async:!0,dataType:"jsonp",data:{cate_id:a,shop_id:$.base64.decode($.cookie("userShopId"))},success:function(a){if(null!=a&&"000"==a.code){var b="<ul>";$.each(a.data,function(a,c){$.each(c.service,function(a,c){b+='<li><span class="name">'+c.servicename+"</span>",b+='<span class="unit">'+c.unit+"</span>",b+='<span class="num">'+c.cost+"</span></li>"})}),b+="</ul>",$(".staff_bottom_content").append(b)}},error:function(){}})}},getShopInfoHandler={shopInfo:function(){h.controller("shop",["$scope","$http",function(a,b){function c(a){$(a).find("input").change(function(){var a=$(this),b=a.get(0).files[0],c=a.parent().parent().attr("img_id"),d=new FileReader;return/image\/\w+/.test(b.type)?(d.onload=function(b){void 0==c?a.parent().parent().attr("count",1):h.indexOf(c)<0&&(a.parent().parent().attr("count",1),h.push(c)),a.parent().addClass("opacity new"),a.parent().parent().css("background-image",'url("'+b.target.result+'")'),a.parent().parent().find(".close").show()},void d.readAsDataURL(b)):(a.parent().parent().css("background-image",""),a.parent().removeClass("opacity new"),layer.msg("请确保文件为图像类型"),a.val(""),!1)})}b({method:"JSONP",url:v,params:{shop_id:$.base64.decode($.cookie("userShopId"))}}).success(function(b){if("000"===b.code){console.log(b);var c=b.data.opentime;c=c.substring(0,10),$("#shop_name").val(b.data.shop_name),$("#shop_describe").val(b.data.shop_describe),$("#shop_age").val(c),$("#shop_ad").val(b.data.shop_address);for(var d=b.data.servicearea.length,e=0;d>e;e++)$("#personal_circle").before('<a class="personal_area service_area" href="javascript:;">'+b.data.servicearea[e]+"</a>");for(var f=b.data.servicetag.length,e=0;f>e;e++)$("#personal_style").before('<a class="personal_style" href="javascript:;">'+b.data.servicetag[e]+"</a>");for(var g=b.data.authentication.length,e=0;g>e;e++)$("#shop_head").append('<img class="fl" src='+b.data.authentication[e]+">");b.data.shop_technics.length>=5?(a.infos=b.data.shop_technics.slice(0,5),$("#technic_add").hide(),$(".detail_p").css("marginTop","100px")):(a.infos=b.data.shop_technics,$("#technic_add").show(),$(".detail_p").css("marginTop","5px")),b.data.shop_technics.length>0?$.each(b.data.shop_technics,function(a,b){$(".detail_p").append("<b>"+b.technics_text+"</b>")}):$(".detail_p").append("<b>随便说点什么吧！</b>"),b.data.shop_imgs.length>=4?(a.imgs=b.data.shop_imgs.slice(0,4),$(".renderings_img").hide()):(a.imgs=b.data.shop_imgs,$(".renderings_img").show())}else layer.layer.msg(b.msg)}).error(function(){});var d=$(".shop_detail_style .edit"),e=$(".shop_detail_area .area_edit"),f=[],g=[];$.ajax({type:"get",url:H,async:!0,dataType:"jsonp",success:function(a){if(null!=a&&"000"==a.code){var b='<div class="tag_content">';$.each(a.data,function(a,c){b+="<span>"+c.stylename+"</span>"}),b+='</div><a href="javascript:;" class="besure">确定</a>',d.append(b).addClass("display")}},error:function(){}}),$("#personal_style").click(function(){d.removeClass("display");for(var a=0;a<$(".shop_detail_style .personal_style").length;a++)f[a]=$(".shop_detail_style .personal_style").eq(a).html();for(var a=0;a<$(".shop_detail_style .edit span").length;a++)$.inArray($(".shop_detail_style .edit span").eq(a).html(),f)>=0&&$(".shop_detail_style .edit span").eq(a).addClass("current");
d.find("span").unbind("click").click(function(){if($(this).hasClass("current")){$(this).removeClass("current");for(var a=0;a<$(".shop_detail_style .personal_style").length;a++)$(this).html()==$(".shop_detail_style .personal_style").eq(a).html()&&$(".shop_detail_style .personal_style").eq(a).remove()}else $(this).addClass("current"),$("#personal_style").before('<a class="personal_style" href="javascript:;">'+$(this).html()+"</a>")}),d.find(".besure").unbind("click").click(function(){d.addClass("display"),f=[]})}),$("#personal_circle").click(function(){e.removeClass("display");for(var a=0;a<$(".shop_detail_area .personal_area").length;a++)g[a]=$(".shop_detail_area .personal_area").eq(a).html();for(var a=0;a<$(".shop_detail_area .area_edit span").length;a++)$.inArray($(".shop_detail_area .area_edit span").eq(a).html(),g)>=0&&$(".shop_detail_area .area_edit span").eq(a).addClass("current");e.find("span").unbind("click").click(function(){if($(this).hasClass("current")){$(this).removeClass("current");for(var a=0;a<$(".shop_detail_area .personal_area").length;a++)$(this).html()==$(".shop_detail_area .personal_area").eq(a).html()&&$(".shop_detail_area .personal_area").eq(a).remove()}else $(this).addClass("current"),$("#personal_circle").before('<a class="personal_area" href="javascript:;">'+$(this).html()+"</a>")}),e.find(".area_sure").unbind("click").click(function(){e.addClass("display"),g=[]})}),$("#shop_save").click(function(){for(var a=[],b=[],c=0;c<$(".personal_style").length;c++)a.push($(".personal_style").eq(c).html());for(var c=0;c<$(".personal_area").length;c++)b.push($(".personal_area").eq(c).html());$.ajax({url:I,type:"GET",async:!0,dataType:"jsonp",data:{shop_id:$.base64.decode($.cookie("userShopId")),shop_name:$("#shop_name").val(),shop_address:$("#shop_ad").val(),shop_describe:$("#shop_describe").val(),servicetag:a,servicearea:b},success:function(a){null!=a&&"000"==a.code&&layer.msg(a.msg)},error:function(){}})}),$(document).off("click","#complete_del").on("click","#complete_del",function(){var c=$(this).attr("technicsid");$.ajax({url:J,type:"GET",async:!0,dataType:"jsonp",data:{technics_id:c},success:function(c){layer.msg(c.msg),$(".detail_p b").remove(),b({method:"JSONP",url:v,params:{shop_id:$.base64.decode($.cookie("userShopId"))}}).success(function(b){"000"===b.code?(b.data.shop_technics.length>=5?(a.infos=b.data.shop_technics.slice(0,5),$("#technic_add").hide(),$(".detail_p").css("marginTop","100px")):(a.infos=b.data.shop_technics,$("#technic_add").show(),$(".detail_p").css("marginTop","5px")),b.data.shop_technics.length>0?$.each(b.data.shop_technics,function(a,b){$(".detail_p").append("<b>"+b.technics_text+"</b>")}):$(".detail_p").append("<b>随便说点什么吧！</b>")):layer.layer.msg(b.msg)}).error(function(){})},error:function(){}})}),$(document).off("click","#img_del").on("click","#img_del",function(){var c=$(this).attr("imgid");$.ajax({url:K,type:"GET",async:!0,dataType:"jsonp",data:{img_id:c},success:function(c){layer.msg(c.msg),b({method:"JSONP",url:v,params:{shop_id:$.base64.decode($.cookie("userShopId"))}}).success(function(b){"000"===b.code?b.data.shop_imgs.length>=4?(a.imgs=b.data.shop_imgs.slice(0,4),$(".renderings_img").hide()):(a.imgs=b.data.shop_imgs,$(".renderings_img").show()):layer.layer.msg(b.msg)}).error(function(){})},error:function(){}})}),$("#technic_add").click(function(){var a=$(this).parents(".right_content_wrap").next(".add_technology");$(".add_technology").css("top",($(window).height()-a.outerHeight())/2+$(document).scrollTop()),$(".add_technology").show().removeClass("hide"),$(".wrap").show().removeClass("hide");var b=$(".add_picture"),c=b.find("a");c.removeClass("opacity"),b.css("background-image",""),b.find(".close").hide(),$("#textarea").val("")});var h=[],i=0;$(document).on("click",".renderings_show_a",function(){$(".add_technology").show().removeClass("hide").addClass("edit"),$(".wrap").show().removeClass("hide");var b=a.infos,c=$(".craft_img");$.each(c,function(a){$(this).data("imgs",b[a].technics_img),$(this).data("text",b[a].technics_text),$(this).data("tid",b[a].technics_id)});var d=$(".add_picture"),e=d.find("a");e.removeClass("opacity new"),d.css("background-image",""),d.find(".close").hide();var f=$(this).prev().prev(),g=f.data("imgs");$.each(g,function(a,b){e.eq(a).addClass("opacity"),d.eq(a).css("background-image","url("+b.technics_img+")"),d.eq(a).find(".close").show(),d.eq(a).attr("img_id",b.img_id),d.eq(a).attr("count",0)}),$(".add_technology").attr("technics_id",f.data("tid")),$("#textarea").html(f.data("text"))}),$("#add_close").click(function(){$(".add_technology").hide(),$(".add_technology").removeClass("edit"),$(".add_technology .add_picture").removeAttr("img_id"),$(".add_technology .add_picture").removeAttr("count"),$(".wrap").hide()}),c(".add_picture"),$(".close").click(function(){$(this).parent().find("a").removeClass("opacity new"),$(this).parent().css("background-image",""),$(this).parent().attr("count",0);var a=$(this).parent().attr("img_id");void 0!=a&&h.indexOf(a)<0&&h.push(a),$(this).hide()}),$(document).off("change","#renderings_file").on("change","#renderings_file",function(){var c=new FormData;c.append("shop_id",$.base64.decode($.cookie("userShopId"))),c.append("myfile",$("#renderings_file")[0].files[0]),$.ajax({url:w,type:"POST",data:c,dataType:"jsonp",jsonp:"callback",cache:!1,processData:!1,contentType:!1,success:function(c){"000"===c.code&&(b({method:"JSONP",url:v,params:{shop_id:$.base64.decode($.cookie("userShopId"))}}).success(function(b){if("000"===b.code){b.data.shop_imgs.length>=4?(a.imgs=b.data.shop_imgs.slice(0,4),$(".renderings_img").hide()):(a.imgs=b.data.shop_imgs,$(".renderings_img").show());var c=$("#renderings_img");c.css("backgroundImage",""),c.find("a").removeClass("opacity")}else layer.msg(b.msg)}),layer.msg(c.msg))},error:function(){alert("错误！！")}})}),$(document).off("click",".complete").on("click",".complete",function(){if($(this).parent().parent().hasClass("edit")){var c=new FormData;c.append("technics_id",$(".add_technology").attr("technics_id")),c.append("describe",$("#textarea").val());for(var d=0;3>d;d++)1==$(".add_technology .add_picture").eq(d).attr("count")&&i++;c.append("count",i),c.append("type",1);for(var d=0;d<h.length;d++)c.append("img_id[]",h[d]);for(var d=1;3>=d;d++)$("#file"+d).val()&&$("#file"+d).parent().hasClass("new")&&c.append("myfile[]",$("#file"+d)[0].files[0]);$.ajax({type:"POST",url:y,data:c,dataType:"jsonp",jsonp:"callback",cache:!1,processData:!1,contentType:!1,success:function(a){"000"==a.code?(layer.msg(a.msg),location.reload(!0)):layer.alert(a.msg)},error:function(){layer.alert("未知错误")}})}else{var c=new FormData;c.append("shop_id",$.base64.decode($.cookie("userShopId"))),c.append("describe",$("#textarea").val());for(var d=1;3>=d;d++)$("#file"+d).val()&&c.append("myfile[]",$("#file"+d)[0].files[0]);$.ajax({url:x,type:"POST",data:c,dataType:"jsonp",jsonp:"callback",cache:!1,processData:!1,contentType:!1,success:function(c){"000"===c.code?($(".detail_p b").remove(),layer.msg(c.msg),$(".add_technology").hide(),$(".wrap").hide(),b({method:"JSONP",url:v,params:{shop_id:$.base64.decode($.cookie("userShopId"))}}).success(function(b){"000"===b.code?(b.data.shop_technics.length>=5?(a.infos=b.data.shop_technics.slice(0,5),$("#technic_add").hide(),$(".detail_p").css("marginTop","100px")):(a.infos=b.data.shop_technics,$("#technic_add").show(),$(".detail_p").css("marginTop","5px")),b.data.shop_technics.length>0?$.each(b.data.shop_technics,function(a,b){$(".detail_p").append("<b>"+b.technics_text+"</b>")}):$(".detail_p").append("<b>随便说点什么吧！</b>")):layer.layer.msg(b.msg)}).error(function(){})):layer.msg(c.msg)},error:function(){alert("错误！！")}})}})}])}},getWorkInfoHandler={workInfo:function(){h.controller("work",["$scope","$http",function(a,b){function c(){b({method:"JSONP",url:z,params:{foreman_id:oa,type:1,limit:4},beforeSend:function(){$(".complete_before .works_detail").remove(),$(".complete_before").append(ha)},complete:function(){$(".complete_before .loading").remove()}}).success(function(b){b&&"000"===b.code?(console.log(b.data),b.data.length>=4?(a.works=b.data.slice(0,4),$(".new_album").hide()):(a.works=b.data,$(".new_album").show()),a.session=function(a){sessionStorage.setItem("case_id",a)}):layer.msg(b.msg)}).error(function(){})}c(),$(document).off("click",".complete_del").on("click",".complete_del",function(){var a=$(this).attr("caseId");$.ajax({url:B,type:"GET",async:!0,dataType:"jsonp",data:{case_id:a},success:function(a){a&&"000"==a.code?(layer.msg(a.msg),c()):layer.msg(a.msg)},error:function(){}})}),$.ajax({type:"get",url:z,async:!0,dataType:"jsonp",data:{foreman_id:oa,type:2,page:1,limit:8},success:function(a){if(a&&"000"===a.code){fa=a.data[0].total;var b="";$.each(a.data,function(a,c){b+=spliceWCompleteContent.spliceStrEvent(c)}),$(".works_complete").html(b),WCompletePageHandler.pageContentEvent()}else"117"==a.code?($(".works_completeWrap").remove(),$(".works_complete_wrap .not_information").show().removeClass("hide"),$(".works_complete_wrap .not_information_text").html("您现在还没有已完成的作品哦~~")):layer.msg(a.msg)},error:function(){}}),$.ajax({type:"get",url:z,async:!0,dataType:"jsonp",data:{foreman_id:oa,type:3,page:1,limit:8},success:function(a){if(a&&"000"===a.code){ga=a.data[0].total;var b="";$.each(a.data,function(a,c){b+=spliceWUndoneContent.spliceStrEvent(c)}),$(".worksPending").html(b),WUndonePageHandler.pageContentEvent()}else"117"==a.code?($(".works_pending").remove(),$(".works_pending_wrap .not_information").show().removeClass("hide"),$(".works_pending_wrap .not_information_text").html("您现在还没有待完成的作品哦~~")):layer.msg(a.msg)},error:function(){}}),$(document).on("click","#detail_bg",function(){sessionStorage.setItem("step",$(this).attr("step")),sessionStorage.setItem("orderId",$(this).attr("orderId")),sessionStorage.setItem("status","已完成"),window.open("order.html#/order")}),$(document).on("click",".undone",function(){sessionStorage.setItem("step",$(this).parents(".works_detail").attr("step")),sessionStorage.setItem("orderId",$(this).parents(".works_detail").attr("orderId")),sessionStorage.setItem("status","订单进行中"),window.open("order.html#/order")})}])}},superSlide={slidePic:function(){$("#success_case").slide({titCell:".hd ul",mainCell:".bg_picture ul",autoPage:!1,trigger:"click",effect:"leftLoop",autoPlay:!1,vis:1})}},ajaxSubmit={confirmAdd:function(){var a=$(".new_areacnt input"),b=$(".room option:selected"),c=$(".hall option:selected"),d=$(".toilet option:selected"),e=$(".balcony option:selected"),f=$(".new_stylecnt span.active"),g=$(".year1 option:selected"),h=$(".month1 option:selected"),i=$(".day1 option:selected"),j=$(".year2 option:selected"),k=$(".month2 option:selected"),l=$(".day2 option:selected"),m=$(".detail_address input"),n=0,o=!0,p=b.val()+"室"+c.val()+"厅"+d.val()+"卫"+e.val()+"阳台",q=g.val()+"."+h.val()+"."+i.val()+"-"+j.val()+"."+k.val()+"."+l.val(),r=new FormData;r.append("foreman_id",oa),r.append("housetype",p),r.append("style",f.html()),r.append("timelong",q),r.append("address",m.val()),r.append("area",a.val());for(var s=1;5>=s;s++)$("#file"+s).val()&&(r.append("myfile[]",$("#file"+s)[0].files[0]),n++);(""==a.val()||null==a.val())&&(errorRemind.errorContent(ia,$(".new_area h3")),o=!1),("请选择"==b.val()||"请选择"==c.val()||"请选择"==d.val()||"请选择"==e.val())&&(errorRemind.errorContent(ja,$(".new_type h3")),o=!1),(""==f.html()||null==f.html())&&(errorRemind.errorContent(ka,$(".new_style h3")),o=!1),"-年份-"==g.html()||"-月份-"==h.html()||"-日期-"==i.html()||"-年份-"==j.html()||"-月份-"==k.html()||"-日期-"==l.html()?(errorRemind.errorContent(la,$(".new_schedule h3")),o=!1):g.html()>j.html()?(errorRemind.errorContent(la,$(".new_schedule h3")),o=!1):g.html()==j.html()&&h.html()>k.html()?(errorRemind.errorContent(la,$(".new_schedule h3")),o=!1):g.html()==j.html()&&h.html()==k.html()&&i.html()>l.html()&&(errorRemind.errorContent(la,$(".new_schedule h3")),o=!1),(""==m.val()||null==m.val())&&(errorRemind.errorContent(ma,$(".new_address h3")),o=!1),0==n&&(errorRemind.errorContent(na,$(".construction_picture h3")),o=!1),o&&$.ajax({type:"post",url:A,dataType:"jsonp",jsonp:"callback",data:r,cache:!1,processData:!1,contentType:!1,success:function(a){"000"==a.code?(window.location.href="#/master/mwork",location.reload(!0)):layer.alert("上传失败")},error:function(){layer.alert("未知错误")}})}},errorRemind={errorContent:function(a,b){b.siblings("label").text(a).addClass("whether")}},removeError={clickEvent:function(){$(".new_work_content>div").on("click",function(){$(this).children("label").removeClass("whether")})}},addPicture={constructionPic:function(){$(".add_picture input").on("change",function(){var a=$(this),b=a.get(0).files[0],c=new FileReader;return c.readAsDataURL(b),/image\/\w+/.test(b.type)?void(c.onload=function(b){a.parent().parent().addClass("clear"),a.parent().siblings(".close").show(),a.parent().parent().css({background:'url("'+b.target.result+'") no-repeat',backgroundSize:"100% 100%"}),$(".close").on("click",function(){$(this).parent().removeClass("clear"),$(this).parent().css("background",""),$(this).hide()})}):(a.parent().parent().css("background",""),a.parent().parent().removeClass("clear"),layer.alert("请确保文件为图像类型"),a.val(""),!1)})}},uploadPictureHandler={uploadAvatar:function(){var a={thumbBox:".thumbBox",spinner:".spinner",imgSrc:"css/img/imgWrap_bg.png"},b=$(".imageBox").cropbox(a);$("#upload-file").on("change",function(){var c=new FileReader;c.onload=function(c){a.imgSrc=c.target.result,b=$(".imageBox").cropbox(a),$(".thumbBox").show().removeClass("hide")},c.readAsDataURL(this.files[0])}),$("#btnCrop").on("click",function(){var a=b.getDataURL(),c=$(".cropped .result_100"),d=$(".cropped .result_50");c.html(""),d.html(""),c.append('<img src="'+a+'" align="absmiddle" style="width:100px;height:100px;box-shadow:0 0 12px #7E7E7E;">'),d.append('<img src="'+a+'" align="absmiddle" style="width:50px;height:50px;box-shadow:0 0 12px #7E7E7E;" >')}),$("#btnZoomIn").on("click",function(){b.zoomIn()}),$("#btnZoomOut").on("click",function(){b.zoomOut()}),$(".imgWrap").hover(function(){disabledMouseWheel.chromeDepend()},function(){window.onmousewheel=document.onmousewheel=!0,document.removeEventListener("DOMMouseScroll",disabledMouseWheel.firefoxDepend,!1)})}},disabledMouseWheel={chromeDepend:function(){document.addEventListener&&document.addEventListener("DOMMouseScroll",disabledMouseWheel.firefoxDepend,!1),window.onmousewheel=document.onmousewheel=disabledMouseWheel.firefoxDepend},firefoxDepend:function(a){return a=a||window.event,a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1),!1}},judgeNews={isnews:function(){$(".main_content").each(function(){"0"==$(this).attr("data-isread")&&$(this).addClass("isnews")})}},readNews={tobeRead:function(){$(".main_content .content").on("click",function(){var a=$(this).siblings(".cnt").html();if(layer.open({type:1,skin:"layui-layer-rim",area:["420px","240px"],content:"<p>"+a+"</p>"}),"0"==$(this).parent().attr("data-isread")){var b=$(this).parent().attr("data-id"),c=$(this).parent(),d=$(".left_ul li i").html();0!=d?(d--,$(".left_ul li i").html(d)):$(".left_ul li i").remove(),$.ajax({type:"get",url:O,async:!0,dataType:"jsonp",data:{msgid:b},success:function(){c.attr("data-isread","1").removeClass("isnews")},error:function(){}})}})}},initInfo={info:function(){$.ajax({type:"get",url:M,async:!0,dataType:"jsonp",data:{user_id:oa,page:1,limit:4},success:function(a){null!=a&&"000"==a.code?($(".main_contentWrap").empty(),d=a.data[0].total,$.each(a.data,function(a,b){var c=spliceContentHandler.spliceStrEvent(b);$(".main_contentWrap").append(c)}),judgeNews.isnews(),readNews.tobeRead(),pageHandler.pageContentEvent(),deleteRecord.singleSelection(),markRead.checkAll()):"117"==a.code?($("#contentWrap").remove(),$(".not_information").show().removeClass("hide"),$(".not_information_text").html("您的消息空空如也~~")):layer.msg(a.msg)},error:function(){}})}},spliceContentHandler={spliceStrEvent:function(a){var b='<div class="main_content" data-isread="'+a.isread+'" data-id="'+a.id+'">';return b+='<span class="name">'+a.senduser+"</span>",b+='<span class="content">'+a.msgtitle+"</span>",b+='<span class="time">'+a.sendtime+"</span>",b+='<span class="cnt">'+a.msgcontent+"</span>",b+='<a class="delete" href="javascript:;"><em class="sprite-details"></em></a>',b+="</div>"}},pageHandler={pageContentEvent:function(){g=Math.ceil(d/4),$(".page_div3").empty().paging({total:g,animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:M,ajaxData:{user_id:oa,page:1,limit:4},dataOperate:function(a){$(".main_contentWrap").empty(),$.each(a.data,function(a,b){var c=spliceContentHandler.spliceStrEvent(b);$(".main_contentWrap").append(c)}),judgeNews.isnews(),readNews.tobeRead(),deleteRecord.singleSelection()}})}},spliceOrderContent={spliceStrEvent:function(a){var b='<div class="order_box" step ="'+a.order_step+'" orderId ="'+a.order_id+'" status ="'+a.order_status+'">';return b+='<div class="ordercnt_title clearfix">',b+="<span>"+a.room+"室"+a.parlour+"厅"+a.toilet+"卫"+a.balcony+"阳台</span>",b+="<span>订单号</span>",b+="<span>"+a.order_id+"</span>",b+="<span>"+a.order_time+"</span>",b+="</div>",b+='<div class="ordercnt_content">',b+='<div class="block clearfix">',b+='<div class="name">',b+="<p>"+a.user_realname+"</p>",b+="<p>"+a.user_phone+"</p>",b+="</div>",b+='<div class="address">',b+="<span>"+a.order_address+"</span>",b+="</div>",b+='<div class="size area">',b+='<p class="item_hover_0">'+a.area+"</p>",b+="</div>",b+='<div class="stage">',b+="<span>"+a.order_status+"</span>",b+="</div>",b+='<div class="money">',b+="<span>"+a.actual_finish_amount+"</span>",b+="</div>",b+='<div class="all">',b+='<a class="progress_updates" target="_blank">进度更新</a>',b+="</div>",b+="</div>",b+='<div class="order_detail display">',b+="<p>户型：三室两厅 &nbsp;&nbsp;餐厅、客厅、卧室、阳台、卫生间</p>",b+="<p>简介：起居室整体色彩干净清爽，浅色的背景墙和沙发让空间基调利落明快，而与之相对比的红色地毯则让空间现代化感更强，且不失活泼。利用侧面的“裸妆”墙体收货一个更为丰富且个性的立体装饰效果，同时也达到了客厅空间的收纳作用。</p>",b+="</div>",b+="</div>",b+="</div>"}},OrderPageHandler={pageContentEvent:function(a,b,c){$(".page_div3").empty().paging({total:Math.ceil(a/3),animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:b,ajaxData:c,dataOperate:function(a){$(".order_wrap").empty();var b="";$.each(a.data.order_list,function(c,d){"1"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待确认":"2"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待预约":"3"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待上门量房":"4"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="待用户预支付":"5"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="订单进行中":"6"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="已完成":"7"==a.data.order_list[c].order_status?a.data.order_list[c].order_status="已取消":"8"==a.data.order_list[c].order_status&&(a.data.order_list[c].order_status="工长店铺取消"),b+=spliceOrderContent.spliceStrEvent(d),$(".order_wrap").html(b)})}})}},spliceWCompleteContent={spliceStrEvent:function(a){var b='<div class="works_detail fl works_bg">';return b+='<div class="detail_img">',b+='<img src="'+a.img[0].case_img+'">',b+="</div><!--detail_img-->",b+='<div id="detail_bg" class="detail_bg clearfix" step ="'+a.order_step+'" orderId ="'+a.case_id+'">',b+='<div class="detail_bg_div">',b+="</div><!--detail_bg_div-->",b+='<div class="detail_bg_content">',b+="<dl>",b+="<dd><span>"+a.area+"</span>m<sup>2</sup></dd>",b+="<dd>"+a.style+"</dd>",b+="<dd>"+a.housetype+"</dd>",b+="</dl>",b+="</div><!--detail_bg_content-->",b+="</div><!--detail_bg-->",b+="</div><!--works_detail-->"}},WCompletePageHandler={pageContentEvent:function(){$(".page_div4").empty().paging({total:Math.ceil(fa/8),animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:z,ajaxData:{foreman_id:oa,type:2,page:1,limit:8},dataOperate:function(a){var b="";$.each(a.data,function(a,c){b+=spliceWCompleteContent.spliceStrEvent(c)}),$(".works_complete").html(b)}})}},spliceWUndoneContent={spliceStrEvent:function(a){var b='<div class="works_detail fl complete_img" step ="'+a.order_step+'" orderId ="'+a.case_id+'">';return b+='<div class="detail_img">',b+='<img src="css/img/my_work1.jpg">',b+="</div><!--detail_img-->",b+='<div class="pending_font undone clearfix">',b+='<em class="address_em sprite_team fl"></em><p class="pending_address fl">'+a.address+"</p>",b+='<p class="pending_name fl"><em class="sprite_team"></em>'+a.area+"</p>",b+='<p class="pending_tel fl"><em class="sprite_team"></em>'+a.housetype+"</p>",b+="</div><!--pending_font-->",b+='<div class="bg undone"></div>',b+="</div><!--works_detail-->"}},WUndonePageHandler={pageContentEvent:function(){$(".page_div5").empty().paging({total:Math.ceil(ga/8),animation:!1,centerBgColor:"#fff",centerFontColor:"#000",centerBorder:"1px solid #ddd",transition:"all .2s",centerHoverBgColor:"#eec988",centerHoverBorder:"1px solid #eec988",centerFontHoverColor:"#fff",otherFontHoverColor:"#fff",otherBorder:"1px solid #ddd",otherHoverBorder:"1px solid #eec988",otherBgColor:"#fff",otherHoverBgColor:"#eec988",currentFontColor:"#fff",currentBgColor:"#eec988",currentBorder:"1px solid #eec988",fontSize:13,currentFontSize:13,cormer:2,gapWidth:3,showJump:!0,jumpBgColor:"#fff",jumpFontHoverColor:"#fff",jumpHoverBgColor:"#eec988",jumpBorder:"1px solid #ddd",jumpHoverBorder:"1px solid #eec988",submitType:"get",idParameter:"page",url:z,ajaxData:{foreman_id:oa,type:3,page:1,limit:8},dataOperate:function(a){var b="";$.each(a.data,function(a,c){b+=spliceWUndoneContent.spliceStrEvent(c)}),$(".WUndonePageHandler").html(b)}})}},deleteRecord={singleSelection:function(){$(".main_contentWrap .delete").on("click",function(){var a=$(this).parent().attr("data-id");$.ajax({type:"get",url:N,async:!0,dataType:"jsonp",data:{id:a},success:function(a){null!=a&&"000"==a.code?(initInfo.info(),layer.msg(a.msg)):layer.alert(a.msg)},error:function(){}})})}},markRead={checkAll:function(){$(".information_choose a").on("click",function(){$(".information_choose input").is(":checked")?$.ajax({type:"get",url:P,async:!0,dataType:"jsonp",data:{user_id:oa},success:function(a){null!=a&&"000"==a.code?($(".main_content").attr("data-isread","1").removeClass("isnews"),$(".left_ul li i").remove()):layer.alert(a.msg)},error:function(){}}):layer.alert("请先选中全选按钮")})}},ra.init()}();